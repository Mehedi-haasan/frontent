"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_aws-amplify_ui-components_dist_esm-es5_amplify-confirm-sign-in_7_entry_js"],{

/***/ "./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js ***!
  \*************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   amplify_confirm_sign_in: function() { return /* binding */ AmplifyConfirmSignIn; },\n/* harmony export */   amplify_confirm_sign_up: function() { return /* binding */ AmplifyConfirmSignUp; },\n/* harmony export */   amplify_forgot_password: function() { return /* binding */ AmplifyForgotPassword; },\n/* harmony export */   amplify_require_new_password: function() { return /* binding */ AmplifyRequireNewPassword; },\n/* harmony export */   amplify_sign_in: function() { return /* binding */ AmplifySignIn; },\n/* harmony export */   amplify_sign_up: function() { return /* binding */ AmplifySignUp; },\n/* harmony export */   amplify_verify_contact: function() { return /* binding */ AmplifyVerifyContact; }\n/* harmony export */ });\n/* harmony import */ var _index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-83f2275b.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/index-83f2275b.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @aws-amplify/core */ \"./node_modules/@aws-amplify/core/lib-esm/index.js\");\n/* harmony import */ var _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth-types-78df304e.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-types-78df304e.js\");\n/* harmony import */ var _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aws-amplify/auth */ \"./node_modules/@aws-amplify/auth/lib-esm/index.js\");\n/* harmony import */ var _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Translations-108d469f.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/Translations-108d469f.js\");\n/* harmony import */ var _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./constants-c8ecaa24.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/constants-c8ecaa24.js\");\n/* harmony import */ var _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./helpers-14fcb50c.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/helpers-14fcb50c.js\");\n/* harmony import */ var _auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./auth-helpers-557b83fc.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-557b83fc.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (undefined && undefined.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\n\n\n\n\n\n\n\n\nvar AmplifyConfirmSignIn = /** @class */ (function () {\n    function class_1(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** Fires when confirm sign in form is submitted */\n        this.handleSubmit = function (event) { return _this.confirm(event); };\n        /** Used for header text in confirm sign in component */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SMS_CODE;\n        /** Used for the submit button text in confirm sign in component */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM;\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** Default form field */\n        this.defaultFormFields = [\n            {\n                type: 'code',\n                required: true,\n                handleInputChange: function (event) { return _this.handleCodeChange(event); },\n            },\n        ];\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = this.defaultFormFields;\n        /** The MFA option to confirm with */\n        this.mfaOption = _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.M.SMS;\n        /* Whether or not the confirm-sign-in component is loading */\n        this.loading = false;\n    }\n    class_1.prototype.componentWillLoad = function () {\n        this.setup();\n    };\n    class_1.prototype.userHandler = function () {\n        this.setup();\n    };\n    class_1.prototype.setup = function () {\n        if (this.user &&\n            this.user['challengeName'] === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.C.SoftwareTokenMFA) {\n            this.mfaOption = _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.M.TOTP;\n            // If header text is using default use TOTP string\n            if (this.headerText === _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SMS_CODE) {\n                this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_TOTP_CODE;\n            }\n        }\n        this.constructedFormFieldOptions = this.constructFormFieldOptions(this.formFields);\n    };\n    class_1.prototype.handleCodeChange = function (event) {\n        this.code = event.target.value;\n    };\n    class_1.prototype.confirm = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var mfaType, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        mfaType = this.user['challengeName'] === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.C.SoftwareTokenMFA\n                            ? _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.C.SoftwareTokenMFA\n                            : null;\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.confirmSignIn !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 4, 5, 6]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.confirmSignIn(this.user, this.code, mfaType)];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, (0,_auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.user, this.handleAuthStateChange)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 6];\n                    case 4:\n                        error_1 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_1);\n                        return [3 /*break*/, 6];\n                    case 5:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_1.prototype.constructFormFieldOptions = function (formFields) {\n        var _this = this;\n        var content = [];\n        if (formFields === undefined)\n            return undefined;\n        if (formFields.length <= 0)\n            return this.defaultFormFields;\n        formFields.forEach(function (formField) {\n            if (typeof formField === 'string' || formField.type !== 'code') {\n                // This is either a `string`, and/or a custom field that isn't `code`. Pass this directly.\n                content.push(formField);\n            }\n            else {\n                // This is a code input field. Attach input handler.\n                content.push(Object.assign({ handleInputChange: function (event) { return _this.handleCodeChange(event); } }, formField));\n            }\n        });\n        return content;\n    };\n    class_1.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), handleSubmit: this.handleSubmit, submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.submitButtonText), loading: this.loading, secondaryFooterContent: (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.BACK_TO_SIGN_IN))) }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.constructedFormFieldOptions }))));\n    };\n    Object.defineProperty(class_1, \"watchers\", {\n        get: function () {\n            return {\n                \"user\": [\"userHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_1;\n}());\nvar AmplifyConfirmSignUp = /** @class */ (function () {\n    function class_2(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** Fires when sign up form is submitted */\n        this.handleSubmit = function (event) { return _this.confirmSignUp(event); };\n        /** Used for header text in confirm sign up component */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_HEADER_TEXT;\n        /** Used for the submit button text in confirm sign up component */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT;\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Auth state change handler for this components\n         * e.g. SignIn -> 'Create Account' link -> SignUp\n         */\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        this.loading = false;\n        this.newFormFields = [];\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.g,\n            phoneNumberValue: null,\n        };\n    }\n    class_2.prototype.componentWillLoad = function () {\n        this.setup();\n    };\n    class_2.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_2.prototype.userHandler = function () {\n        this.setup();\n    };\n    class_2.prototype.setup = function () {\n        // TODO: Use optional chaining instead\n        this.userInput = this.user && this.user.username;\n        this._signUpAttrs = this.user && this.user.signUpAttrs;\n        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_2.prototype.buildDefaultFormFields = function () {\n        var _this = this;\n        this.newFormFields = [\n            {\n                type: \"\" + this.usernameAlias,\n                required: true,\n                handleInputChange: this.handleFormFieldInputChange(\"\" + this.usernameAlias),\n                value: this.userInput,\n                disabled: this.userInput ? true : false,\n                inputProps: { autocomplete: 'username' },\n            },\n            {\n                type: 'code',\n                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_CODE_LABEL),\n                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_CODE_PLACEHOLDER),\n                required: true,\n                hint: ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_LOST_CODE), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.resendConfirmCode(); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_RESEND_CODE)))),\n                handleInputChange: this.handleFormFieldInputChange('code'),\n            },\n        ];\n    };\n    class_2.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_1 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                if (newField.type === 'code') {\n                    newField['hint'] = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.i)(newField) ? ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_LOST_CODE), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.resendConfirmCode(); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_RESEND_CODE)))) : (newField['hint']);\n                }\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                newFields_1.push(newField);\n            });\n            this.newFormFields = newFields_1;\n        }\n    };\n    class_2.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.h)(event, _this.phoneNumber); };\n            case 'code':\n                return function (event) { return (_this.code = event.target.value); };\n            default:\n                return;\n        }\n    };\n    class_2.prototype.setFieldValue = function (field) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    this.userInput = '';\n                }\n                else {\n                    this.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n        }\n    };\n    class_2.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    /**\n     * Returns the username of the user to confirm. If a valid `user.username` has been passed as a prop, we return that.\n     * Otherwise, we return the `userInput` on the form.\n     */\n    class_2.prototype.getUsername = function () {\n        if (this.user && this.user.username)\n            return this.user.username;\n        switch (this.usernameAlias) {\n            case 'username':\n            case 'email':\n                return this.userInput;\n            case 'phone_number':\n                return (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.b)(this.phoneNumber);\n        }\n    };\n    class_2.prototype.resendConfirmCode = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var username, error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.resendSignUp !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        username = this.getUsername();\n                        if (!username)\n                            throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.EMPTY_USERNAME);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.resendSignUp(username.trim())];\n                    case 2:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_2 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // TODO: Add validation\n    // TODO: Prefix\n    class_2.prototype.confirmSignUp = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var username, confirmSignUpResult, error_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.confirmSignUp !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, 7, 8]);\n                        username = this.getUsername();\n                        if (!username)\n                            throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.EMPTY_USERNAME);\n                        username = username.trim();\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.confirmSignUp(username, this.code)];\n                    case 2:\n                        confirmSignUpResult = _a.sent();\n                        if (!confirmSignUpResult) {\n                            throw new Error(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CONFIRM_SIGN_UP_FAILED));\n                        }\n                        if (!(this._signUpAttrs &&\n                            this._signUpAttrs.password &&\n                            this._signUpAttrs.password !== '')) return [3 /*break*/, 4];\n                        // Auto sign in user if password is available from previous workflow\n                        return [4 /*yield*/, (0,_auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__.h)(username, this._signUpAttrs.password, this.handleAuthStateChange)];\n                    case 3:\n                        // Auto sign in user if password is available from previous workflow\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn);\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        error_3 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_3);\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_2.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.submitButtonText), handleSubmit: this.handleSubmit, loading: this.loading, secondaryFooterContent: (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.BACK_TO_SIGN_IN)))) }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    Object.defineProperty(class_2, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"],\n                \"user\": [\"userHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_2;\n}());\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.Logger('ForgotPassword');\nvar AmplifyForgotPassword = /** @class */ (function () {\n    function class_3(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** The header text of the forgot password section */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.RESET_YOUR_PASSWORD;\n        /** The text displayed inside of the send code button for the form */\n        this.sendButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SEND_CODE;\n        /** The text displayed inside of the submit button for the form */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SUBMIT;\n        /** The form fields displayed inside of the forgot password form */\n        this.formFields = [];\n        /** The function called when making a request to reset password */\n        this.handleSend = function (event) { return _this.send(event); };\n        /** The function called when submitting a new password */\n        this.handleSubmit = function (event) { return _this.submit(event); };\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        this.delivery = null;\n        this.loading = false;\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.g,\n            phoneNumberValue: null,\n        };\n        this.newFormFields = [];\n        this.forgotPasswordAttrs = {\n            userInput: '',\n            password: '',\n            code: '',\n        };\n    }\n    class_3.prototype.componentWillLoad = function () {\n        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_3.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_3.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_2 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                newFields_2.push(newField);\n            });\n            this.newFormFields = newFields_2;\n        }\n    };\n    class_3.prototype.buildDefaultFormFields = function () {\n        switch (this.usernameAlias) {\n            case 'email':\n                this.newFormFields = [\n                    {\n                        type: 'email',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'forgot-password-email-input',\n                        },\n                    },\n                ];\n                break;\n            case 'phone_number':\n                this.newFormFields = [\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'forgot-password-phone-number-input',\n                        },\n                    },\n                ];\n                break;\n            case 'username':\n            default:\n                this.newFormFields = [\n                    {\n                        type: 'username',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('username'),\n                        inputProps: {\n                            'data-test': 'forgot-password-username-input',\n                        },\n                    },\n                ];\n                break;\n        }\n    };\n    class_3.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.forgotPasswordAttrs.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.h)(event, _this.phoneNumber); };\n            case 'password':\n            case 'code':\n                return function (event) { return (_this.forgotPasswordAttrs[fieldType] = event.target.value); };\n            default:\n                return;\n        }\n    };\n    class_3.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    formAttributes.userInput = '';\n                }\n                else {\n                    formAttributes.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            case 'password':\n            case 'code':\n                if (field.value === undefined) {\n                    formAttributes[field.type] = '';\n                }\n                else {\n                    formAttributes[field.type] = field.value;\n                }\n                break;\n        }\n    };\n    class_3.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_3.prototype.send = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, error_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.forgotPassword !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        switch (this.usernameAlias) {\n                            case 'phone_number':\n                                try {\n                                    this.forgotPasswordAttrs.userInput = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.b)(this.phoneNumber);\n                                }\n                                catch (error) {\n                                    (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error);\n                                }\n                                break;\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.forgotPassword(this.forgotPasswordAttrs.userInput.trim())];\n                    case 2:\n                        data = _a.sent();\n                        logger.debug(data);\n                        this.newFormFields = [\n                            {\n                                type: 'code',\n                                required: true,\n                                handleInputChange: this.handleFormFieldInputChange('code'),\n                                inputProps: {\n                                    'data-test': 'forgot-password-code-input',\n                                },\n                            },\n                            {\n                                type: 'password',\n                                required: true,\n                                handleInputChange: this.handleFormFieldInputChange('password'),\n                                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.NEW_PASSWORD_LABEL),\n                                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.NEW_PASSWORD_PLACEHOLDER),\n                            },\n                        ];\n                        this.delivery = data.CodeDeliveryDetails;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_4 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_4);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_3.prototype.submit = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, userInput, code, password, data, error_5;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.forgotPasswordSubmit !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, 4, 5]);\n                        _a = this.forgotPasswordAttrs, userInput = _a.userInput, code = _a.code, password = _a.password;\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.forgotPasswordSubmit(userInput.trim(), code, password)];\n                    case 2:\n                        data = _b.sent();\n                        logger.debug(data);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn);\n                        this.delivery = null;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_5 = _b.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_5);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_3.prototype.render = function () {\n        var _this = this;\n        var submitFn = this.delivery\n            ? function (event) { return _this.handleSubmit(event); }\n            : function (event) { return _this.handleSend(event); };\n        var submitButtonText = this.delivery\n            ? this.submitButtonText\n            : this.sendButtonText;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), handleSubmit: submitFn, loading: this.loading, secondaryFooterContent: (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn); }, \"data-test\": \"forgot-password-back-to-sign-in-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.BACK_TO_SIGN_IN)), testDataPrefix: 'forgot-password', submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(submitButtonText) }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    Object.defineProperty(class_3, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_3;\n}());\nvar logger$1 = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.ConsoleLogger('amplify-require-new-password');\nvar AmplifyRequireNewPassword = /** @class */ (function () {\n    function class_4(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** The header text of the forgot password section */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CHANGE_PASSWORD;\n        /** The text displayed inside of the submit button for the form */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CHANGE_PASSWORD_ACTION;\n        /** The function called when submitting a new password */\n        this.handleSubmit = function (event) { return _this.completeNewPassword(event); };\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** The form fields displayed inside of the forgot password form */\n        this.formFields = [\n            {\n                type: _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.a.Password,\n                required: true,\n                handleInputChange: function (event) { return _this.handlePasswordChange(event); },\n                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.NEW_PASSWORD_LABEL),\n                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.NEW_PASSWORD_PLACEHOLDER),\n                inputProps: {\n                    'data-test': 'require-new-password-password-input',\n                },\n            },\n        ];\n        this.loading = false;\n        this.requiredAttributes = {};\n        this.newFormFields = this.formFields;\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.g,\n            phoneNumberValue: ' ',\n        };\n    }\n    class_4.prototype.userHandler = function () {\n        this.setCurrentUser();\n    };\n    class_4.prototype.handleRequiredAttributeInputChange = function (attribute, event) {\n        if (attribute === 'phone_number') {\n            this.formatPhoneNumber(event);\n        }\n        else {\n            this.requiredAttributes[attribute] = event.target.value;\n        }\n    };\n    class_4.prototype.setCurrentUser = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var user, error_6, userRequiredAttributes, requiredAttributesMap_1;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!this.user) return [3 /*break*/, 5];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.currentAuthenticatedUser()];\n                    case 2:\n                        user = _a.sent();\n                        if (user)\n                            this.currentUser = user;\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_6 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_6);\n                        return [3 /*break*/, 4];\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        this.currentUser = this.user;\n                        _a.label = 6;\n                    case 6:\n                        if (this.currentUser &&\n                            this.currentUser.challengeParam &&\n                            this.currentUser.challengeParam.requiredAttributes) {\n                            userRequiredAttributes = this.currentUser.challengeParam\n                                .requiredAttributes;\n                            requiredAttributesMap_1 = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.g)();\n                            userRequiredAttributes.forEach(function (attribute) {\n                                var formField = {\n                                    type: attribute,\n                                    required: true,\n                                    label: requiredAttributesMap_1[attribute].label,\n                                    placeholder: requiredAttributesMap_1[attribute].placeholder,\n                                    handleInputChange: function (event) { return _this.handleRequiredAttributeInputChange(attribute, event); },\n                                    inputProps: {\n                                        'data-test': \"require-new-password-\" + attribute + \"-input\",\n                                    },\n                                };\n                                _this.newFormFields = __spreadArrays(_this.newFormFields, [formField]);\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_4.prototype.componentWillLoad = function () {\n        return this.setCurrentUser();\n    };\n    class_4.prototype.handlePasswordChange = function (event) {\n        this.password = event.target.value;\n    };\n    class_4.prototype.formatPhoneNumber = function (event) {\n        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.h)(event, this.phoneNumber);\n        /**\n         * composePhoneNumberInput will throw an error if the phoneNumberValue it receives\n         * is empty. Adding a check here to try and make sure that doesn't happen...but will\n         * wrap it in a try/catch block just in case as well\n         */\n        try {\n            if (event.target.name === _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.b &&\n                this.phoneNumber.phoneNumberValue) {\n                var composedInput = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.b)(this.phoneNumber);\n                this.requiredAttributes['phone_number'] = composedInput;\n            }\n        }\n        catch (err) {\n            logger$1.error(\"error in phone number field - \" + err);\n        }\n    };\n    class_4.prototype.completeNewPassword = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var user, _a, error_7;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.completeNewPassword !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 8, 9, 10]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.completeNewPassword(this.currentUser, this.password, this.requiredAttributes)];\n                    case 2:\n                        user = _b.sent();\n                        logger$1.debug('complete new password', user);\n                        _a = user.challengeName;\n                        switch (_a) {\n                            case _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.C.SMSMFA: return [3 /*break*/, 3];\n                            case _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.C.MFASetup: return [3 /*break*/, 4];\n                        }\n                        return [3 /*break*/, 5];\n                    case 3:\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.ConfirmSignIn, user);\n                        return [3 /*break*/, 7];\n                    case 4:\n                        logger$1.debug('TOTP setup', user.challengeParam);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.TOTPSetup, user);\n                        return [3 /*break*/, 7];\n                    case 5: return [4 /*yield*/, (0,_auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__.c)(user, this.handleAuthStateChange)];\n                    case 6:\n                        _b.sent();\n                        _b.label = 7;\n                    case 7: return [3 /*break*/, 10];\n                    case 8:\n                        error_7 = _b.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_7);\n                        return [3 /*break*/, 10];\n                    case 9:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 10: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_4.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), handleSubmit: this.handleSubmit, loading: this.loading, secondaryFooterContent: (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.BACK_TO_SIGN_IN)), submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.submitButtonText) }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    Object.defineProperty(class_4, \"watchers\", {\n        get: function () {\n            return {\n                \"user\": [\"userHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_4;\n}());\nvar amplifySignInCss = \":host{--footer-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--footer-font-family:var(--amplify-font-family);--font-weight:var(--amplify-font-weight)}.sign-in-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-in-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-in-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-in-form-footer amplify-button{margin-bottom:0}}.sign-in-form-footer *+*{margin-bottom:15px}.full-width-footer-content{width:100%}\";\nvar AmplifySignIn = /** @class */ (function () {\n    function class_5(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** Fires when sign in form is submitted */\n        this.handleSubmit = function (event) { return _this.signIn(event); };\n        /** Used for header text in sign in component */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_IN_HEADER_TEXT;\n        /** Used for the submit button text in sign in component */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_IN_ACTION;\n        /** Auth state change handler for this component */\n        // prettier-ignore\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Hides the sign up link */\n        this.hideSignUp = false;\n        this.newFormFields = [];\n        /* Whether or not the sign-in component is loading */\n        this.loading = false;\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.g,\n            phoneNumberValue: null,\n        };\n        this.signInAttributes = {\n            userInput: '',\n            password: '',\n        };\n    }\n    class_5.prototype.componentWillLoad = function () {\n        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_5.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_5.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.signInAttributes.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.h)(event, _this.phoneNumber); };\n            case 'password':\n                return function (event) { return (_this.signInAttributes.password = event.target.value); };\n            default:\n                return function () { };\n        }\n    };\n    class_5.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_5.prototype.signIn = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var username;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // avoid submitting the form\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        this.loading = true;\n                        switch (this.usernameAlias) {\n                            case 'phone_number':\n                                try {\n                                    this.signInAttributes.userInput = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.b)(this.phoneNumber);\n                                }\n                                catch (error) {\n                                    (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error);\n                                }\n                        }\n                        username = this.signInAttributes.userInput.trim();\n                        return [4 /*yield*/, (0,_auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__.h)(username, this.signInAttributes.password, this.handleAuthStateChange, this.usernameAlias)];\n                    case 1:\n                        _a.sent();\n                        this.loading = false;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_5.prototype.buildDefaultFormFields = function () {\n        var _this = this;\n        var formFieldInputs = [];\n        switch (this.usernameAlias) {\n            case 'email':\n                formFieldInputs.push({\n                    type: 'email',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('email'),\n                    inputProps: {\n                        'data-test': 'sign-in-email-input',\n                        autocomplete: 'username',\n                    },\n                });\n                break;\n            case 'phone_number':\n                formFieldInputs.push({\n                    type: 'phone_number',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                    inputProps: {\n                        'data-test': 'sign-in-phone-number-input',\n                        autocomplete: 'username',\n                    },\n                });\n                break;\n            case 'username':\n            default:\n                formFieldInputs.push({\n                    type: 'username',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('username'),\n                    inputProps: {\n                        'data-test': 'sign-in-username-input',\n                        autocomplete: 'username',\n                    },\n                });\n                break;\n        }\n        formFieldInputs.push({\n            type: 'password',\n            hint: ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.FORGOT_PASSWORD_TEXT), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.ForgotPassword); }, \"data-test\": \"sign-in-forgot-password-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.RESET_PASSWORD_TEXT)))),\n            required: true,\n            handleInputChange: this.handleFormFieldInputChange('password'),\n            inputProps: {\n                'data-test': 'sign-in-password-input',\n            },\n        });\n        this.newFormFields = __spreadArrays(formFieldInputs);\n    };\n    class_5.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_3 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                // TODO: handle hint better\n                if (newField.type === 'password') {\n                    newField['hint'] = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.i)(newField) ? ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.FORGOT_PASSWORD_TEXT), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.ForgotPassword); }, \"data-test\": \"sign-in-forgot-password-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.RESET_PASSWORD_TEXT)))) : (newField['hint']);\n                }\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                _this.setFieldValue(newField, _this.signInAttributes);\n                newFields_3.push(newField);\n            });\n            this.newFormFields = newFields_3;\n        }\n    };\n    class_5.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    formAttributes.userInput = '';\n                }\n                else {\n                    formAttributes.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            case 'password':\n                if (field.value === undefined) {\n                    formAttributes.password = '';\n                }\n                else {\n                    formAttributes.password = field.value;\n                }\n                break;\n        }\n    };\n    class_5.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), handleSubmit: this.handleSubmit, testDataPrefix: 'sign-in' }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", { slot: \"subtitle\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"header-subtitle\" })), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"federated-buttons\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-federated-buttons\", { handleAuthStateChange: this.handleAuthStateChange, federated: this.federated })), !(0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.isEmpty)(this.federated) && (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-strike\", null, \"or\"), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.newFormFields }), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", { slot: \"amplify-form-section-footer\", class: \"sign-in-form-footer\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"footer\" }, !this.hideSignUp && ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"secondary-footer-content\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.NO_ACCOUNT_TEXT), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignUp); }, \"data-test\": \"sign-in-create-account-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CREATE_ACCOUNT_TEXT))))), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", { class: this.hideSignUp ? 'full-width-footer-content' : '' }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"primary-footer-content\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { type: \"submit\", disabled: this.loading, \"data-test\": \"sign-in-sign-in-button\" }, this.loading ? ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-loading-spinner\", null)) : ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.submitButtonText)))))))))));\n    };\n    Object.defineProperty(class_5, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_5;\n}());\nAmplifySignIn.style = amplifySignInCss;\nvar amplifySignUpCss = \"amplify-sign-up{--footer-font-family:var(--amplify-font-family);--footer-font-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--font-weight:var(--amplify-font-weight)}.sign-up-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-font-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-up-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-up-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-up-form-footer amplify-button{margin-bottom:0}}.sign-up-form-footer *+*{margin-bottom:15px}\";\nvar AmplifySignUp = /** @class */ (function () {\n    function class_6(hostRef) {\n        var _this = this;\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** Fires when sign up form is submitted */\n        this.handleSubmit = function (event) { return _this.signUp(event); };\n        /** Override for handling the Auth.SignUp API call */\n        this.handleSignUp = function (params) { return _this.authSignUp(params); };\n        /** Used for header text in sign up component */\n        this.headerText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_HEADER_TEXT;\n        /** Used for the submit button text in sign up component */\n        this.submitButtonText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_SUBMIT_BUTTON_TEXT;\n        /** Used for the submit button text in sign up component */\n        this.haveAccountText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_HAVE_ACCOUNT_TEXT;\n        /** Text used for the sign in hyperlink */\n        this.signInText = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_IN_TEXT;\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Auth state change handler for this component\n         * e.g. SignIn -> 'Create Account' link -> SignUp\n         */\n        // prettier-ignore\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        // private userInput: string | PhoneNumberInterface;\n        this.newFormFields = [];\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.g,\n            phoneNumberValue: null,\n        };\n        this.loading = false;\n        this.signUpAttributes = {\n            username: '',\n            password: '',\n            attributes: {},\n        };\n    }\n    class_6.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n                return function (event) { return (_this.signUpAttributes.username = event.target.value); };\n            case 'password':\n                return function (event) { return (_this.signUpAttributes.password = event.target.value); };\n            case 'email':\n                return function (event) { return (_this.signUpAttributes.attributes.email = event.target.value); };\n            case 'phone_number':\n                return function (event) { return (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.h)(event, _this.phoneNumber); };\n            default:\n                return function (event) { return (_this.signUpAttributes.attributes[fieldType] = event.target.value); };\n        }\n    };\n    class_6.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_6.prototype.authSignUp = function (params) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.signUp(params)];\n                    case 1:\n                        data = _a.sent();\n                        if (!data) {\n                            throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_FAILED);\n                        }\n                        return [2 /*return*/, data];\n                }\n            });\n        });\n    };\n    class_6.prototype.assignPhoneNumberToSignUpAttributes = function () {\n        if (this.phoneNumber.phoneNumberValue) {\n            try {\n                this.signUpAttributes.attributes.phone_number = (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.b)(this.phoneNumber);\n            }\n            catch (error) {\n                (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error);\n            }\n        }\n    };\n    class_6.prototype.assignUserNameAliasToSignUpAttributes = function () {\n        switch (this.usernameAlias) {\n            case 'email':\n            case 'phone_number':\n                this.signUpAttributes.username = this.signUpAttributes.attributes[this.usernameAlias];\n                break;\n        }\n    };\n    class_6.prototype.assignFormInputToSignUpAttributes = function () {\n        this.assignPhoneNumberToSignUpAttributes();\n        this.assignUserNameAliasToSignUpAttributes();\n    };\n    class_6.prototype.validateSignUpAttributes = function () {\n        if (!this.signUpAttributes.username) {\n            if (this.usernameAlias === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.U.email) {\n                throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.EMPTY_EMAIL);\n            }\n            else if (this.usernameAlias === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.U.phone_number) {\n                throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.EMPTY_PHONE);\n            }\n            else {\n                throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.EMPTY_USERNAME);\n            }\n        }\n        if (this.signUpAttributes.username.indexOf(' ') >= 0) {\n            throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.USERNAME_REMOVE_WHITESPACE);\n        }\n        if (this.signUpAttributes.password !== this.signUpAttributes.password.trim()) {\n            throw new Error(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.PASSWORD_REMOVE_WHITESPACE);\n        }\n    };\n    // TODO: Add validation\n    // TODO: Prefix\n    class_6.prototype.signUp = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, signUpAttrs, error_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.signUp !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        this.assignFormInputToSignUpAttributes();\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, 7, 8]);\n                        this.validateSignUpAttributes();\n                        return [4 /*yield*/, this.handleSignUp(this.signUpAttributes)];\n                    case 2:\n                        data = _a.sent();\n                        if (!data.userConfirmed) return [3 /*break*/, 4];\n                        return [4 /*yield*/, (0,_auth_helpers_557b83fc_js__WEBPACK_IMPORTED_MODULE_5__.h)(this.signUpAttributes.username, this.signUpAttributes.password, this.handleAuthStateChange)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        signUpAttrs = Object.assign({}, this.signUpAttributes);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.ConfirmSignUp, Object.assign(Object.assign({}, data.user), { signUpAttrs: signUpAttrs }));\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        error_8 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_8);\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_6.prototype.buildDefaultFormFields = function () {\n        switch (this.usernameAlias) {\n            case 'email':\n                this.newFormFields = [\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                            autocomplete: 'username',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                            autocomplete: 'new-password',\n                        },\n                    },\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                            autocomplete: 'tel-national',\n                        },\n                    },\n                ];\n                break;\n            case 'phone_number':\n                this.newFormFields = [\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                            autocomplete: 'username',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                            autocomplete: 'new-password',\n                        },\n                    },\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                            autocomplete: 'email',\n                        },\n                    },\n                ];\n                break;\n            case 'username':\n            default:\n                this.newFormFields = [\n                    {\n                        type: 'username',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_USERNAME_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('username'),\n                        inputProps: {\n                            'data-test': 'sign-up-username-input',\n                            autocomplete: 'username',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                            autocomplete: 'new-password',\n                        },\n                    },\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                        },\n                    },\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                        },\n                    },\n                ];\n                break;\n        }\n    };\n    class_6.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_4 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                _this.setFieldValue(field, _this.signUpAttributes);\n                newFields_4.push(newField);\n            });\n            this.newFormFields = newFields_4;\n        }\n    };\n    class_6.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n                if (field.value === undefined) {\n                    formAttributes.username = '';\n                }\n                else {\n                    formAttributes.username = field.value;\n                }\n                break;\n            case 'password':\n                if (field.value === undefined) {\n                    formAttributes.password = '';\n                }\n                else {\n                    formAttributes.password = field.value;\n                }\n                break;\n            case 'email':\n                formAttributes.attributes.email = field.value;\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            default:\n                formAttributes.attributes[field.type] = field.value;\n                break;\n        }\n    };\n    class_6.prototype.componentWillLoad = function () {\n        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.c)(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_6.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_6.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.headerText), handleSubmit: this.handleSubmit, testDataPrefix: 'sign-up' }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", { slot: \"subtitle\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"header-subtitle\" })), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-auth-fields\", { formFields: this.newFormFields }), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", { class: \"sign-up-form-footer\", slot: \"amplify-form-section-footer\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"footer\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"secondary-footer-content\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.haveAccountText), ' ', (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignIn); }, \"data-test\": \"sign-up-sign-in-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.signInText)))), (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"slot\", { name: \"primary-footer-content\" }, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { type: \"submit\", \"data-test\": \"sign-up-create-account-button\", disabled: this.loading }, this.loading ? ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-loading-spinner\", null)) : ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(this.submitButtonText))))))))));\n    };\n    Object.defineProperty(class_6, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_6;\n}());\nAmplifySignUp.style = amplifySignUpCss;\nvar logger$2 = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.Logger('AmplifyVerifyContact');\nvar AmplifyVerifyContact = /** @class */ (function () {\n    function class_7(hostRef) {\n        (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);\n        /** Authentication state handler */\n        this.handleAuthStateChange = _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.d;\n        this.loading = false;\n    }\n    class_7.prototype.handleSubmit = function (event) {\n        event.preventDefault();\n        this.verifyAttr ? this.submit(this.code) : this.verify(this.contact);\n    };\n    class_7.prototype.submit = function (code) {\n        return __awaiter(this, void 0, void 0, function () {\n            var attr, data, error_9;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        attr = this.verifyAttr;\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.verifyCurrentUserAttributeSubmit !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.verifyCurrentUserAttributeSubmit(attr, code)];\n                    case 2:\n                        data = _a.sent();\n                        logger$2.debug(data);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignedIn, this.user);\n                        this.verifyAttr = null;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_9 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_9);\n                        logger$2.error(error_9);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_7.prototype.verify = function (contact) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, error_10;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!contact) {\n                            logger$2.error('Neither Email nor Phone Number selected');\n                            return [2 /*return*/];\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.verifyCurrentUserAttribute !== 'function') {\n                            throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_3__.N);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_6__.Auth.verifyCurrentUserAttribute(contact)];\n                    case 2:\n                        data = _a.sent();\n                        logger$2.debug(data);\n                        this.verifyAttr = contact;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_10 = _a.sent();\n                        (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_4__.a)(error_10);\n                        logger$2.error(error_10);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_7.prototype.handleInputChange = function (event) {\n        var inputName = event.target.name;\n        if (inputName === 'code') {\n            this.code = event.target.value;\n        }\n        else if (inputName === 'contact') {\n            this.contact = event.target.value;\n        }\n    };\n    class_7.prototype.renderSubmit = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-input\", { inputProps: {\n                autocomplete: 'off',\n                'data-test': 'verify-contact-code-input',\n            }, name: \"code\", placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.CODE_PLACEHOLDER), handleInputChange: function (event) { return _this.handleInputChange(event); } })));\n    };\n    class_7.prototype.renderVerify = function () {\n        var _this = this;\n        var user = this.user;\n        if (!user) {\n            logger$2.debug('No user to verify');\n            return null;\n        }\n        var unverified = user.unverified;\n        if (!unverified) {\n            logger$2.debug('Unverified variable does not exist on user');\n            return null;\n        }\n        var email = unverified.email, phone_number = unverified.phone_number;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"div\", null, email && ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-radio-button\", { label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.VERIFY_CONTACT_EMAIL_LABEL), key: \"email\", name: \"contact\", value: \"email\", handleInputChange: function (event) { return _this.handleInputChange(event); }, inputProps: {\n                'data-test': 'verify-contact-email-radio',\n            } })), phone_number && ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-radio-button\", { label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.VERIFY_CONTACT_PHONE_LABEL), key: \"phone_number\", name: \"contact\", value: \"phone_number\", handleInputChange: function (event) { return _this.handleInputChange(event); }, inputProps: {\n                'data-test': 'verify-contact-phone-number-radio',\n            } }))));\n    };\n    class_7.prototype.render = function () {\n        var _this = this;\n        return ((0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-form-section\", { handleSubmit: function (event) { return _this.handleSubmit(event); }, headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.VERIFY_CONTACT_HEADER_TEXT), loading: this.loading, secondaryFooterContent: (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"span\", null, (0,_index_83f2275b_js__WEBPACK_IMPORTED_MODULE_0__.h)(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__.A.SignedIn, _this.user); }, \"data-test\": \"verify-contact-skip-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.SKIP))), submitButtonText: this.verifyAttr\n                ? _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.VERIFY_CONTACT_SUBMIT_LABEL)\n                : _aws_amplify_core__WEBPACK_IMPORTED_MODULE_7__.I18n.get(_Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_2__.T.VERIFY_CONTACT_VERIFY_LABEL) }, this.verifyAttr ? this.renderSubmit() : this.renderVerify())));\n    };\n    return class_7;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2FtcGxpZnktY29uZmlybS1zaWduLWluXzcuZW50cnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsbUJBQW1CLFNBQUksSUFBSSxTQUFJO0FBQy9CLGNBQWMsNkJBQTZCLDBCQUEwQixjQUFjLHFCQUFxQjtBQUN4RyxpQkFBaUIsb0RBQW9ELHFFQUFxRSxjQUFjO0FBQ3hKLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDLG1DQUFtQyxTQUFTO0FBQzVDLG1DQUFtQyxXQUFXLFVBQVU7QUFDeEQsMENBQTBDLGNBQWM7QUFDeEQ7QUFDQSw4R0FBOEcsT0FBTztBQUNySCxpRkFBaUYsaUJBQWlCO0FBQ2xHLHlEQUF5RCxnQkFBZ0IsUUFBUTtBQUNqRiwrQ0FBK0MsZ0JBQWdCLGdCQUFnQjtBQUMvRTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0EsVUFBVSxZQUFZLGFBQWEsU0FBUyxVQUFVO0FBQ3RELG9DQUFvQyxTQUFTO0FBQzdDO0FBQ0E7QUFDQSxzQkFBc0IsU0FBSSxJQUFJLFNBQUk7QUFDbEMsa0RBQWtELFFBQVE7QUFDMUQseUNBQXlDLFFBQVE7QUFDakQseURBQXlELFFBQVE7QUFDakU7QUFDQTtBQUNBO0FBQzBFO0FBQ0Q7QUFDNkQ7QUFDN0Y7QUFDc0I7QUFDd0Q7QUFDcUg7QUFDMUo7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEI7QUFDQSwrQ0FBK0M7QUFDL0M7QUFD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QUFDQTtBQUNBLGdCQUFnQixxREFBQyxDQUFDLGlEQUFJLFFBQVEscURBQUMsMkJBQTJCLGlDQUFpQyxtQ0FBbUMsY0FBYyxtREFBSSxLQUFLLHdEQUFZLDZFQUE2RSxxREFBQyxlQUFlLHFEQUFDLHFCQUFxQiwwQ0FBMEMsbUNBQW1DLHNEQUFTLHlCQUF5QiwyQ0FBMkMsRUFBRSxtREFBSSxLQUFLLHdEQUFZO0FBQ3JjLGtCQUFrQixtREFBSSxLQUFLLHdEQUFZO0FBQ3ZDLGtCQUFrQixtREFBSSxLQUFLLHdEQUFZLCtCQUErQjtBQUN0RTtBQUNBO0FBQ0EsQ0FBQztBQUM0VSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2FtcGxpZnktY29uZmlybS1zaWduLWluXzcuZW50cnkuanM/N2E1NiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcbiAgICByZXR1cm4gcjtcbn07XG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGgsIEggYXMgSG9zdCB9IGZyb20gJy4vaW5kZXgtODNmMjI3NWIuanMnO1xuaW1wb3J0IHsgSTE4biwgTG9nZ2VyLCBDb25zb2xlTG9nZ2VyLCBpc0VtcHR5IH0gZnJvbSAnQGF3cy1hbXBsaWZ5L2NvcmUnO1xuaW1wb3J0IHsgTSBhcyBNZmFPcHRpb24sIEMgYXMgQ2hhbGxlbmdlTmFtZSwgQSBhcyBBdXRoU3RhdGUsIGEgYXMgQXV0aEZvcm1GaWVsZCwgVSBhcyBVc2VybmFtZUFsaWFzIH0gZnJvbSAnLi9hdXRoLXR5cGVzLTc4ZGYzMDRlLmpzJztcbmltcG9ydCB7IEF1dGggfSBmcm9tICdAYXdzLWFtcGxpZnkvYXV0aCc7XG5pbXBvcnQgeyBUIGFzIFRyYW5zbGF0aW9ucyB9IGZyb20gJy4vVHJhbnNsYXRpb25zLTEwOGQ0NjlmLmpzJztcbmltcG9ydCB7IE4gYXMgTk9fQVVUSF9NT0RVTEVfRk9VTkQsIGcgYXMgQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCwgYiBhcyBQSE9ORV9TVUZGSVggfSBmcm9tICcuL2NvbnN0YW50cy1jOGVjYWEyNC5qcyc7XG5pbXBvcnQgeyBkIGFzIGRpc3BhdGNoQXV0aFN0YXRlQ2hhbmdlRXZlbnQsIGEgYXMgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50LCBjIGFzIGNoZWNrVXNlcm5hbWVBbGlhcywgaSBhcyBpc0hpbnRWYWxpZCwgaCBhcyBoYW5kbGVQaG9uZU51bWJlckNoYW5nZSwgYiBhcyBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCwgZyBhcyBnZXRSZXF1aXJlZEF0dHJpYnV0ZXNNYXAgfSBmcm9tICcuL2hlbHBlcnMtMTRmY2I1MGMuanMnO1xuaW1wb3J0IHsgYyBhcyBjaGVja0NvbnRhY3QsIGggYXMgaGFuZGxlU2lnbkluIH0gZnJvbSAnLi9hdXRoLWhlbHBlcnMtNTU3YjgzZmMuanMnO1xudmFyIEFtcGxpZnlDb25maXJtU2lnbkluID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzEoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBjb25maXJtIHNpZ24gaW4gZm9ybSBpcyBzdWJtaXR0ZWQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmNvbmZpcm0oZXZlbnQpOyB9O1xuICAgICAgICAvKiogVXNlZCBmb3IgaGVhZGVyIHRleHQgaW4gY29uZmlybSBzaWduIGluIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLmhlYWRlclRleHQgPSBUcmFuc2xhdGlvbnMuQ09ORklSTV9TTVNfQ09ERTtcbiAgICAgICAgLyoqIFVzZWQgZm9yIHRoZSBzdWJtaXQgYnV0dG9uIHRleHQgaW4gY29uZmlybSBzaWduIGluIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvblRleHQgPSBUcmFuc2xhdGlvbnMuQ09ORklSTTtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIERlZmF1bHQgZm9ybSBmaWVsZCAqL1xuICAgICAgICB0aGlzLmRlZmF1bHRGb3JtRmllbGRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdjb2RlJyxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVDb2RlQ2hhbmdlKGV2ZW50KTsgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGb3JtIGZpZWxkcyBhbGxvd3MgeW91IHRvIHV0aWxpemUgb3VyIHByZS1idWlsdCBjb21wb25lbnRzIHN1Y2ggYXMgdXNlcm5hbWUgZmllbGQsIGNvZGUgZmllbGQsIHBhc3N3b3JkIGZpZWxkLCBlbWFpbCBmaWVsZCwgZXRjLlxuICAgICAgICAgKiBieSBwYXNzaW5nIGFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCB5b3Ugd291bGQgbGlrZSB0aGUgb3JkZXIgb2YgdGhlIGZvcm0gdG8gYmUgaW4uIElmIHlvdSBuZWVkIG1vcmUgY3VzdG9taXphdGlvbiwgc3VjaCBhcyBjaGFuZ2luZ1xuICAgICAgICAgKiB0ZXh0IGZvciBhIGxhYmVsIG9yIGFkanVzdCBhIHBsYWNlaG9sZGVyLCB5b3UgY2FuIGZvbGxvdyB0aGUgc3RydWN0dXJlIGJlbG93IGluIG9yZGVyIHRvIGRvIGp1c3QgdGhhdC5cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqIFtcbiAgICAgICAgICogIHtcbiAgICAgICAgICogICAgdHlwZTogc3RyaW5nLFxuICAgICAgICAgKiAgICBsYWJlbDogc3RyaW5nLFxuICAgICAgICAgKiAgICBwbGFjZWhvbGRlcjogc3RyaW5nLFxuICAgICAgICAgKiAgICBoaW50OiBzdHJpbmcgfCBGdW5jdGlvbmFsIENvbXBvbmVudCB8IG51bGwsXG4gICAgICAgICAqICAgIHJlcXVpcmVkOiBib29sZWFuXG4gICAgICAgICAqICB9XG4gICAgICAgICAqIF1cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvcm1GaWVsZHMgPSB0aGlzLmRlZmF1bHRGb3JtRmllbGRzO1xuICAgICAgICAvKiogVGhlIE1GQSBvcHRpb24gdG8gY29uZmlybSB3aXRoICovXG4gICAgICAgIHRoaXMubWZhT3B0aW9uID0gTWZhT3B0aW9uLlNNUztcbiAgICAgICAgLyogV2hldGhlciBvciBub3QgdGhlIGNvbmZpcm0tc2lnbi1pbiBjb21wb25lbnQgaXMgbG9hZGluZyAqL1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgY2xhc3NfMS5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0dXAoKTtcbiAgICB9O1xuICAgIGNsYXNzXzEucHJvdG90eXBlLnVzZXJIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfTtcbiAgICBjbGFzc18xLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudXNlciAmJlxuICAgICAgICAgICAgdGhpcy51c2VyWydjaGFsbGVuZ2VOYW1lJ10gPT09IENoYWxsZW5nZU5hbWUuU29mdHdhcmVUb2tlbk1GQSkge1xuICAgICAgICAgICAgdGhpcy5tZmFPcHRpb24gPSBNZmFPcHRpb24uVE9UUDtcbiAgICAgICAgICAgIC8vIElmIGhlYWRlciB0ZXh0IGlzIHVzaW5nIGRlZmF1bHQgdXNlIFRPVFAgc3RyaW5nXG4gICAgICAgICAgICBpZiAodGhpcy5oZWFkZXJUZXh0ID09PSBUcmFuc2xhdGlvbnMuQ09ORklSTV9TTVNfQ09ERSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyVGV4dCA9IFRyYW5zbGF0aW9ucy5DT05GSVJNX1RPVFBfQ09ERTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbnN0cnVjdGVkRm9ybUZpZWxkT3B0aW9ucyA9IHRoaXMuY29uc3RydWN0Rm9ybUZpZWxkT3B0aW9ucyh0aGlzLmZvcm1GaWVsZHMpO1xuICAgIH07XG4gICAgY2xhc3NfMS5wcm90b3R5cGUuaGFuZGxlQ29kZUNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLmNvZGUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgfTtcbiAgICBjbGFzc18xLnByb3RvdHlwZS5jb25maXJtID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZmFUeXBlLCBlcnJvcl8xO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1mYVR5cGUgPSB0aGlzLnVzZXJbJ2NoYWxsZW5nZU5hbWUnXSA9PT0gQ2hhbGxlbmdlTmFtZS5Tb2Z0d2FyZVRva2VuTUZBXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBDaGFsbGVuZ2VOYW1lLlNvZnR3YXJlVG9rZW5NRkFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGguY29uZmlybVNpZ25JbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDQsIDUsIDZdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguY29uZmlybVNpZ25Jbih0aGlzLnVzZXIsIHRoaXMuY29kZSwgbWZhVHlwZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjaGVja0NvbnRhY3QodGhpcy51c2VyLCB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNsYXNzXzEucHJvdG90eXBlLmNvbnN0cnVjdEZvcm1GaWVsZE9wdGlvbnMgPSBmdW5jdGlvbiAoZm9ybUZpZWxkcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY29udGVudCA9IFtdO1xuICAgICAgICBpZiAoZm9ybUZpZWxkcyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGZvcm1GaWVsZHMubGVuZ3RoIDw9IDApXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Rm9ybUZpZWxkcztcbiAgICAgICAgZm9ybUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmb3JtRmllbGQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm9ybUZpZWxkID09PSAnc3RyaW5nJyB8fCBmb3JtRmllbGQudHlwZSAhPT0gJ2NvZGUnKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBlaXRoZXIgYSBgc3RyaW5nYCwgYW5kL29yIGEgY3VzdG9tIGZpZWxkIHRoYXQgaXNuJ3QgYGNvZGVgLiBQYXNzIHRoaXMgZGlyZWN0bHkuXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKGZvcm1GaWVsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgY29kZSBpbnB1dCBmaWVsZC4gQXR0YWNoIGlucHV0IGhhbmRsZXIuXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKE9iamVjdC5hc3NpZ24oeyBoYW5kbGVJbnB1dENoYW5nZTogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVDb2RlQ2hhbmdlKGV2ZW50KTsgfSB9LCBmb3JtRmllbGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH07XG4gICAgY2xhc3NfMS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGVhZGVyVGV4dDogSTE4bi5nZXQodGhpcy5oZWFkZXJUZXh0KSwgaGFuZGxlU3VibWl0OiB0aGlzLmhhbmRsZVN1Ym1pdCwgc3VibWl0QnV0dG9uVGV4dDogSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSwgbG9hZGluZzogdGhpcy5sb2FkaW5nLCBzZWNvbmRhcnlGb290ZXJDb250ZW50OiBoKFwic3BhblwiLCBudWxsLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkJBQ0tfVE9fU0lHTl9JTikpKSB9LCBoKFwiYW1wbGlmeS1hdXRoLWZpZWxkc1wiLCB7IGZvcm1GaWVsZHM6IHRoaXMuY29uc3RydWN0ZWRGb3JtRmllbGRPcHRpb25zIH0pKSkpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzXzEsIFwid2F0Y2hlcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgXCJ1c2VyXCI6IFtcInVzZXJIYW5kbGVyXCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGNsYXNzXzE7XG59KCkpO1xudmFyIEFtcGxpZnlDb25maXJtU2lnblVwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzIoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBzaWduIHVwIGZvcm0gaXMgc3VibWl0dGVkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5jb25maXJtU2lnblVwKGV2ZW50KTsgfTtcbiAgICAgICAgLyoqIFVzZWQgZm9yIGhlYWRlciB0ZXh0IGluIGNvbmZpcm0gc2lnbiB1cCBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLkNPTkZJUk1fU0lHTl9VUF9IRUFERVJfVEVYVDtcbiAgICAgICAgLyoqIFVzZWQgZm9yIHRoZSBzdWJtaXQgYnV0dG9uIHRleHQgaW4gY29uZmlybSBzaWduIHVwIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvblRleHQgPSBUcmFuc2xhdGlvbnMuQ09ORklSTV9TSUdOX1VQX1NVQk1JVF9CVVRUT05fVEVYVDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZvcm0gZmllbGRzIGFsbG93cyB5b3UgdG8gdXRpbGl6ZSBvdXIgcHJlLWJ1aWx0IGNvbXBvbmVudHMgc3VjaCBhcyB1c2VybmFtZSBmaWVsZCwgY29kZSBmaWVsZCwgcGFzc3dvcmQgZmllbGQsIGVtYWlsIGZpZWxkLCBldGMuXG4gICAgICAgICAqIGJ5IHBhc3NpbmcgYW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IHlvdSB3b3VsZCBsaWtlIHRoZSBvcmRlciBvZiB0aGUgZm9ybSB0byBiZSBpbi4gSWYgeW91IG5lZWQgbW9yZSBjdXN0b21pemF0aW9uLCBzdWNoIGFzIGNoYW5naW5nXG4gICAgICAgICAqIHRleHQgZm9yIGEgbGFiZWwgb3IgYWRqdXN0IGEgcGxhY2Vob2xkZXIsIHlvdSBjYW4gZm9sbG93IHRoZSBzdHJ1Y3R1cmUgYmVsb3cgaW4gb3JkZXIgdG8gZG8ganVzdCB0aGF0LlxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogW1xuICAgICAgICAgKiAge1xuICAgICAgICAgKiAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgICAgICAqICAgIHBsYWNlaG9sZGVyOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGhpbnQ6IHN0cmluZyB8IEZ1bmN0aW9uYWwgQ29tcG9uZW50IHwgbnVsbCxcbiAgICAgICAgICogICAgcmVxdWlyZWQ6IGJvb2xlYW5cbiAgICAgICAgICogIH1cbiAgICAgICAgICogXVxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICAvKiogQXV0aCBzdGF0ZSBjaGFuZ2UgaGFuZGxlciBmb3IgdGhpcyBjb21wb25lbnRzXG4gICAgICAgICAqIGUuZy4gU2lnbkluIC0+ICdDcmVhdGUgQWNjb3VudCcgbGluayAtPiBTaWduVXBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIFVzZXJuYW1lIEFsaWFzIGlzIHVzZWQgdG8gc2V0dXAgYXV0aGVudGljYXRpb24gd2l0aCBgdXNlcm5hbWVgLCBgZW1haWxgIG9yIGBwaG9uZV9udW1iZXJgICAqL1xuICAgICAgICB0aGlzLnVzZXJuYW1lQWxpYXMgPSAndXNlcm5hbWUnO1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW107XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSB7XG4gICAgICAgICAgICBjb3VudHJ5RGlhbENvZGVWYWx1ZTogQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyVmFsdWU6IG51bGwsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfTtcbiAgICBjbGFzc18yLnByb3RvdHlwZS5mb3JtRmllbGRzSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5idWlsZEZvcm1GaWVsZHMoKTtcbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLnVzZXJIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldHVwKCk7XG4gICAgfTtcbiAgICBjbGFzc18yLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gVE9ETzogVXNlIG9wdGlvbmFsIGNoYWluaW5nIGluc3RlYWRcbiAgICAgICAgdGhpcy51c2VySW5wdXQgPSB0aGlzLnVzZXIgJiYgdGhpcy51c2VyLnVzZXJuYW1lO1xuICAgICAgICB0aGlzLl9zaWduVXBBdHRycyA9IHRoaXMudXNlciAmJiB0aGlzLnVzZXIuc2lnblVwQXR0cnM7XG4gICAgICAgIGNoZWNrVXNlcm5hbWVBbGlhcyh0aGlzLnVzZXJuYW1lQWxpYXMpO1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiXCIgKyB0aGlzLnVzZXJuYW1lQWxpYXMsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoXCJcIiArIHRoaXMudXNlcm5hbWVBbGlhcyksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudXNlcklucHV0LFxuICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnVzZXJJbnB1dCA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7IGF1dG9jb21wbGV0ZTogJ3VzZXJuYW1lJyB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnY29kZScsXG4gICAgICAgICAgICAgICAgbGFiZWw6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfQ09ERV9MQUJFTCksXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfQ09ERV9QTEFDRUhPTERFUiksXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGludDogKGgoXCJkaXZcIiwgbnVsbCwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkNPTkZJUk1fU0lHTl9VUF9MT1NUX0NPREUpLCAnICcsIGgoXCJhbXBsaWZ5LWJ1dHRvblwiLCB7IHZhcmlhbnQ6IFwiYW5jaG9yXCIsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlc2VuZENvbmZpcm1Db2RlKCk7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkNPTkZJUk1fU0lHTl9VUF9SRVNFTkRfQ09ERSkpKSksXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ2NvZGUnKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG4gICAgfTtcbiAgICBjbGFzc18yLnByb3RvdHlwZS5idWlsZEZvcm1GaWVsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmZvcm1GaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRGVmYXVsdEZvcm1GaWVsZHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdGaWVsZHNfMSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5mb3JtRmllbGRzLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0ZpZWxkID0gT2JqZWN0LmFzc2lnbih7fSwgZmllbGQpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdGaWVsZC50eXBlID09PSAnY29kZScpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RmllbGRbJ2hpbnQnXSA9IGlzSGludFZhbGlkKG5ld0ZpZWxkKSA/IChoKFwiZGl2XCIsIG51bGwsIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfTE9TVF9DT0RFKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZXNlbmRDb25maXJtQ29kZSgpOyB9IH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfUkVTRU5EX0NPREUpKSkpIDogKG5ld0ZpZWxkWydoaW50J10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXdGaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXSA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2soZXZlbnQsIGZpZWxkKTsgfTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHNfMS5wdXNoKG5ld0ZpZWxkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gbmV3RmllbGRzXzE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlID0gZnVuY3Rpb24gKGZpZWxkVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy51c2VySW5wdXQgPSBldmVudC50YXJnZXQudmFsdWUpOyB9O1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBoYW5kbGVQaG9uZU51bWJlckNoYW5nZShldmVudCwgX3RoaXMucGhvbmVOdW1iZXIpOyB9O1xuICAgICAgICAgICAgY2FzZSAnY29kZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLmNvZGUgPSBldmVudC50YXJnZXQudmFsdWUpOyB9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLnNldEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgc3dpdGNoIChmaWVsZC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VySW5wdXQgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXNlcklucHV0ID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQuZGlhbENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5jb3VudHJ5RGlhbENvZGVWYWx1ZSA9IGZpZWxkLmRpYWxDb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXZlbnQsIGZpZWxkKSB7XG4gICAgICAgIHZhciBmblRvQ2FsbCA9IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA/IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA6IGZ1bmN0aW9uIChldmVudCwgY2IpIHtcbiAgICAgICAgICAgICAgICBjYihldmVudCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKGZpZWxkLnR5cGUpO1xuICAgICAgICBmblRvQ2FsbChldmVudCwgY2FsbGJhY2suYmluZCh0aGlzKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB1c2VybmFtZSBvZiB0aGUgdXNlciB0byBjb25maXJtLiBJZiBhIHZhbGlkIGB1c2VyLnVzZXJuYW1lYCBoYXMgYmVlbiBwYXNzZWQgYXMgYSBwcm9wLCB3ZSByZXR1cm4gdGhhdC5cbiAgICAgKiBPdGhlcndpc2UsIHdlIHJldHVybiB0aGUgYHVzZXJJbnB1dGAgb24gdGhlIGZvcm0uXG4gICAgICovXG4gICAgY2xhc3NfMi5wcm90b3R5cGUuZ2V0VXNlcm5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnVzZXIgJiYgdGhpcy51c2VyLnVzZXJuYW1lKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXNlci51c2VybmFtZTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51c2VySW5wdXQ7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCh0aGlzLnBob25lTnVtYmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUucmVzZW5kQ29uZmlybUNvZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB1c2VybmFtZSwgZXJyb3JfMjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGgucmVzZW5kU2lnblVwICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gdGhpcy5nZXRVc2VybmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VybmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoVHJhbnNsYXRpb25zLkVNUFRZX1VTRVJOQU1FKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGgucmVzZW5kU2lnblVwKHVzZXJuYW1lLnRyaW0oKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl8yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvLyBUT0RPOiBBZGQgdmFsaWRhdGlvblxuICAgIC8vIFRPRE86IFByZWZpeFxuICAgIGNsYXNzXzIucHJvdG90eXBlLmNvbmZpcm1TaWduVXAgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHVzZXJuYW1lLCBjb25maXJtU2lnblVwUmVzdWx0LCBlcnJvcl8zO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5jb25maXJtU2lnblVwICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNiwgNywgOF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWUgPSB0aGlzLmdldFVzZXJuYW1lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXJuYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihUcmFuc2xhdGlvbnMuRU1QVFlfVVNFUk5BTUUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWUgPSB1c2VybmFtZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmNvbmZpcm1TaWduVXAodXNlcm5hbWUsIHRoaXMuY29kZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtU2lnblVwUmVzdWx0ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maXJtU2lnblVwUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfRkFJTEVEKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLl9zaWduVXBBdHRycyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NpZ25VcEF0dHJzLnBhc3N3b3JkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2lnblVwQXR0cnMucGFzc3dvcmQgIT09ICcnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBdXRvIHNpZ24gaW4gdXNlciBpZiBwYXNzd29yZCBpcyBhdmFpbGFibGUgZnJvbSBwcmV2aW91cyB3b3JrZmxvd1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgaGFuZGxlU2lnbkluKHVzZXJuYW1lLCB0aGlzLl9zaWduVXBBdHRycy5wYXNzd29yZCwgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXV0byBzaWduIGluIHVzZXIgaWYgcGFzc3dvcmQgaXMgYXZhaWxhYmxlIGZyb20gcHJldmlvdXMgd29ya2Zsb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuU2lnbkluKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl8zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhlYWRlclRleHQ6IEkxOG4uZ2V0KHRoaXMuaGVhZGVyVGV4dCksIHN1Ym1pdEJ1dHRvblRleHQ6IEkxOG4uZ2V0KHRoaXMuc3VibWl0QnV0dG9uVGV4dCksIGhhbmRsZVN1Ym1pdDogdGhpcy5oYW5kbGVTdWJtaXQsIGxvYWRpbmc6IHRoaXMubG9hZGluZywgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcImRpdlwiLCBudWxsLCBoKFwic3BhblwiLCBudWxsLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkJBQ0tfVE9fU0lHTl9JTikpKSkgfSwgaChcImFtcGxpZnktYXV0aC1maWVsZHNcIiwgeyBmb3JtRmllbGRzOiB0aGlzLm5ld0Zvcm1GaWVsZHMgfSkpKSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xhc3NfMiwgXCJ3YXRjaGVyc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBcImZvcm1GaWVsZHNcIjogW1wiZm9ybUZpZWxkc0hhbmRsZXJcIl0sXG4gICAgICAgICAgICAgICAgXCJ1c2VyXCI6IFtcInVzZXJIYW5kbGVyXCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGNsYXNzXzI7XG59KCkpO1xudmFyIGxvZ2dlciA9IG5ldyBMb2dnZXIoJ0ZvcmdvdFBhc3N3b3JkJyk7XG52YXIgQW1wbGlmeUZvcmdvdFBhc3N3b3JkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzMoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogVGhlIGhlYWRlciB0ZXh0IG9mIHRoZSBmb3Jnb3QgcGFzc3dvcmQgc2VjdGlvbiAqL1xuICAgICAgICB0aGlzLmhlYWRlclRleHQgPSBUcmFuc2xhdGlvbnMuUkVTRVRfWU9VUl9QQVNTV09SRDtcbiAgICAgICAgLyoqIFRoZSB0ZXh0IGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIHNlbmQgY29kZSBidXR0b24gZm9yIHRoZSBmb3JtICovXG4gICAgICAgIHRoaXMuc2VuZEJ1dHRvblRleHQgPSBUcmFuc2xhdGlvbnMuU0VORF9DT0RFO1xuICAgICAgICAvKiogVGhlIHRleHQgZGlzcGxheWVkIGluc2lkZSBvZiB0aGUgc3VibWl0IGJ1dHRvbiBmb3IgdGhlIGZvcm0gKi9cbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b25UZXh0ID0gVHJhbnNsYXRpb25zLlNVQk1JVDtcbiAgICAgICAgLyoqIFRoZSBmb3JtIGZpZWxkcyBkaXNwbGF5ZWQgaW5zaWRlIG9mIHRoZSBmb3Jnb3QgcGFzc3dvcmQgZm9ybSAqL1xuICAgICAgICB0aGlzLmZvcm1GaWVsZHMgPSBbXTtcbiAgICAgICAgLyoqIFRoZSBmdW5jdGlvbiBjYWxsZWQgd2hlbiBtYWtpbmcgYSByZXF1ZXN0IHRvIHJlc2V0IHBhc3N3b3JkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU2VuZCA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuc2VuZChldmVudCk7IH07XG4gICAgICAgIC8qKiBUaGUgZnVuY3Rpb24gY2FsbGVkIHdoZW4gc3VibWl0dGluZyBhIG5ldyBwYXNzd29yZCAqL1xuICAgICAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuc3VibWl0KGV2ZW50KTsgfTtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIFVzZXJuYW1lIEFsaWFzIGlzIHVzZWQgdG8gc2V0dXAgYXV0aGVudGljYXRpb24gd2l0aCBgdXNlcm5hbWVgLCBgZW1haWxgIG9yIGBwaG9uZV9udW1iZXJgICAqL1xuICAgICAgICB0aGlzLnVzZXJuYW1lQWxpYXMgPSAndXNlcm5hbWUnO1xuICAgICAgICB0aGlzLmRlbGl2ZXJ5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSB7XG4gICAgICAgICAgICBjb3VudHJ5RGlhbENvZGVWYWx1ZTogQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyVmFsdWU6IG51bGwsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICB0aGlzLmZvcmdvdFBhc3N3b3JkQXR0cnMgPSB7XG4gICAgICAgICAgICB1c2VySW5wdXQ6ICcnLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgY29kZTogJycsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzMucHJvdG90eXBlLmNvbXBvbmVudFdpbGxMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja1VzZXJuYW1lQWxpYXModGhpcy51c2VybmFtZUFsaWFzKTtcbiAgICAgICAgdGhpcy5idWlsZEZvcm1GaWVsZHMoKTtcbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLmZvcm1GaWVsZHNIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuYnVpbGRGb3JtRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5mb3JtRmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5idWlsZERlZmF1bHRGb3JtRmllbGRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3RmllbGRzXzIgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZm9ybUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdGaWVsZCA9IE9iamVjdC5hc3NpZ24oe30sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXSA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2soZXZlbnQsIGZpZWxkKTsgfTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHNfMi5wdXNoKG5ld0ZpZWxkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gbmV3RmllbGRzXzI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLmJ1aWxkRGVmYXVsdEZvcm1GaWVsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy51c2VybmFtZUFsaWFzKSB7XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnZW1haWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ2ZvcmdvdC1wYXNzd29yZC1lbWFpbC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bob25lX251bWJlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwaG9uZV9udW1iZXInKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ2ZvcmdvdC1wYXNzd29yZC1waG9uZS1udW1iZXItaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCd1c2VybmFtZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnZm9yZ290LXBhc3N3b3JkLXVzZXJuYW1lLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZmllbGRUeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHN3aXRjaCAoZmllbGRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLmZvcmdvdFBhc3N3b3JkQXR0cnMudXNlcklucHV0ID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gaGFuZGxlUGhvbmVOdW1iZXJDaGFuZ2UoZXZlbnQsIF90aGlzLnBob25lTnVtYmVyKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NvZGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5mb3Jnb3RQYXNzd29yZEF0dHJzW2ZpZWxkVHlwZV0gPSBldmVudC50YXJnZXQudmFsdWUpOyB9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLnNldEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAoZmllbGQsIGZvcm1BdHRyaWJ1dGVzKSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnVzZXJJbnB1dCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcklucHV0ID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQuZGlhbENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5jb3VudHJ5RGlhbENvZGVWYWx1ZSA9IGZpZWxkLmRpYWxDb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NvZGUnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzW2ZpZWxkLnR5cGVdID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlc1tmaWVsZC50eXBlXSA9IGZpZWxkLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXZlbnQsIGZpZWxkKSB7XG4gICAgICAgIHZhciBmblRvQ2FsbCA9IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA/IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA6IGZ1bmN0aW9uIChldmVudCwgY2IpIHtcbiAgICAgICAgICAgICAgICBjYihldmVudCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKGZpZWxkLnR5cGUpO1xuICAgICAgICBmblRvQ2FsbChldmVudCwgY2FsbGJhY2suYmluZCh0aGlzKSk7XG4gICAgfTtcbiAgICBjbGFzc18zLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhLCBlcnJvcl80O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5mb3Jnb3RQYXNzd29yZCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3Jnb3RQYXNzd29yZEF0dHJzLnVzZXJJbnB1dCA9IGNvbXBvc2VQaG9uZU51bWJlcklucHV0KHRoaXMucGhvbmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCA0LCA1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmZvcmdvdFBhc3N3b3JkKHRoaXMuZm9yZ290UGFzc3dvcmRBdHRycy51c2VySW5wdXQudHJpbSgpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29kZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnY29kZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ2ZvcmdvdC1wYXNzd29yZC1jb2RlLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwYXNzd29yZCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogSTE4bi5nZXQoVHJhbnNsYXRpb25zLk5FV19QQVNTV09SRF9MQUJFTCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuTkVXX1BBU1NXT1JEX1BMQUNFSE9MREVSKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsaXZlcnkgPSBkYXRhLkNvZGVEZWxpdmVyeURldGFpbHM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfNCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl80KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLnN1Ym1pdCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2EsIHVzZXJJbnB1dCwgY29kZSwgcGFzc3dvcmQsIGRhdGEsIGVycm9yXzU7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLmZvcmdvdFBhc3N3b3JkU3VibWl0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgMywgNCwgNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLmZvcmdvdFBhc3N3b3JkQXR0cnMsIHVzZXJJbnB1dCA9IF9hLnVzZXJJbnB1dCwgY29kZSA9IF9hLmNvZGUsIHBhc3N3b3JkID0gX2EucGFzc3dvcmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmZvcmdvdFBhc3N3b3JkU3VibWl0KHVzZXJJbnB1dC50cmltKCksIGNvZGUsIHBhc3N3b3JkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuU2lnbkluKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsaXZlcnkgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzUgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGFzc18zLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzdWJtaXRGbiA9IHRoaXMuZGVsaXZlcnlcbiAgICAgICAgICAgID8gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVTdWJtaXQoZXZlbnQpOyB9XG4gICAgICAgICAgICA6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlU2VuZChldmVudCk7IH07XG4gICAgICAgIHZhciBzdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5kZWxpdmVyeVxuICAgICAgICAgICAgPyB0aGlzLnN1Ym1pdEJ1dHRvblRleHRcbiAgICAgICAgICAgIDogdGhpcy5zZW5kQnV0dG9uVGV4dDtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhlYWRlclRleHQ6IEkxOG4uZ2V0KHRoaXMuaGVhZGVyVGV4dCksIGhhbmRsZVN1Ym1pdDogc3VibWl0Rm4sIGxvYWRpbmc6IHRoaXMubG9hZGluZywgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pOyB9LCBcImRhdGEtdGVzdFwiOiBcImZvcmdvdC1wYXNzd29yZC1iYWNrLXRvLXNpZ24taW4tbGlua1wiIH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5CQUNLX1RPX1NJR05fSU4pKSwgdGVzdERhdGFQcmVmaXg6ICdmb3Jnb3QtcGFzc3dvcmQnLCBzdWJtaXRCdXR0b25UZXh0OiBJMThuLmdldChzdWJtaXRCdXR0b25UZXh0KSB9LCBoKFwiYW1wbGlmeS1hdXRoLWZpZWxkc1wiLCB7IGZvcm1GaWVsZHM6IHRoaXMubmV3Rm9ybUZpZWxkcyB9KSkpKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbGFzc18zLCBcIndhdGNoZXJzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFwiZm9ybUZpZWxkc1wiOiBbXCJmb3JtRmllbGRzSGFuZGxlclwiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBjbGFzc18zO1xufSgpKTtcbnZhciBsb2dnZXIkMSA9IG5ldyBDb25zb2xlTG9nZ2VyKCdhbXBsaWZ5LXJlcXVpcmUtbmV3LXBhc3N3b3JkJyk7XG52YXIgQW1wbGlmeVJlcXVpcmVOZXdQYXNzd29yZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc180KGhvc3RSZWYpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgLyoqIFRoZSBoZWFkZXIgdGV4dCBvZiB0aGUgZm9yZ290IHBhc3N3b3JkIHNlY3Rpb24gKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLkNIQU5HRV9QQVNTV09SRDtcbiAgICAgICAgLyoqIFRoZSB0ZXh0IGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIHN1Ym1pdCBidXR0b24gZm9yIHRoZSBmb3JtICovXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5DSEFOR0VfUEFTU1dPUkRfQUNUSU9OO1xuICAgICAgICAvKiogVGhlIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIHN1Ym1pdHRpbmcgYSBuZXcgcGFzc3dvcmQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmNvbXBsZXRlTmV3UGFzc3dvcmQoZXZlbnQpOyB9O1xuICAgICAgICAvKiogQXV0aCBzdGF0ZSBjaGFuZ2UgaGFuZGxlciBmb3IgdGhpcyBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UgPSBkaXNwYXRjaEF1dGhTdGF0ZUNoYW5nZUV2ZW50O1xuICAgICAgICAvKiogVGhlIGZvcm0gZmllbGRzIGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIGZvcmdvdCBwYXNzd29yZCBmb3JtICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBBdXRoRm9ybUZpZWxkLlBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZVBhc3N3b3JkQ2hhbmdlKGV2ZW50KTsgfSxcbiAgICAgICAgICAgICAgICBsYWJlbDogSTE4bi5nZXQoVHJhbnNsYXRpb25zLk5FV19QQVNTV09SRF9MQUJFTCksXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5ORVdfUEFTU1dPUkRfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdyZXF1aXJlLW5ldy1wYXNzd29yZC1wYXNzd29yZC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG4gICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlcXVpcmVkQXR0cmlidXRlcyA9IHt9O1xuICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSB0aGlzLmZvcm1GaWVsZHM7XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSB7XG4gICAgICAgICAgICBjb3VudHJ5RGlhbENvZGVWYWx1ZTogQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyVmFsdWU6ICcgJyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY2xhc3NfNC5wcm90b3R5cGUudXNlckhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0Q3VycmVudFVzZXIoKTtcbiAgICB9O1xuICAgIGNsYXNzXzQucHJvdG90eXBlLmhhbmRsZVJlcXVpcmVkQXR0cmlidXRlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoYXR0cmlidXRlLCBldmVudCkge1xuICAgICAgICBpZiAoYXR0cmlidXRlID09PSAncGhvbmVfbnVtYmVyJykge1xuICAgICAgICAgICAgdGhpcy5mb3JtYXRQaG9uZU51bWJlcihldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlcXVpcmVkQXR0cmlidXRlc1thdHRyaWJ1dGVdID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc180LnByb3RvdHlwZS5zZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHVzZXIsIGVycm9yXzYsIHVzZXJSZXF1aXJlZEF0dHJpYnV0ZXMsIHJlcXVpcmVkQXR0cmlidXRlc01hcF8xO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMudXNlcikgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmN1cnJlbnRBdXRoZW50aWNhdGVkVXNlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzYgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfNik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHRoaXMudXNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyLmNoYWxsZW5nZVBhcmFtICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlci5jaGFsbGVuZ2VQYXJhbS5yZXF1aXJlZEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyUmVxdWlyZWRBdHRyaWJ1dGVzID0gdGhpcy5jdXJyZW50VXNlci5jaGFsbGVuZ2VQYXJhbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVxdWlyZWRBdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkQXR0cmlidXRlc01hcF8xID0gZ2V0UmVxdWlyZWRBdHRyaWJ1dGVzTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclJlcXVpcmVkQXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm1GaWVsZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGF0dHJpYnV0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlcXVpcmVkQXR0cmlidXRlc01hcF8xW2F0dHJpYnV0ZV0ubGFiZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogcmVxdWlyZWRBdHRyaWJ1dGVzTWFwXzFbYXR0cmlidXRlXS5wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZVJlcXVpcmVkQXR0cmlidXRlSW5wdXRDaGFuZ2UoYXR0cmlidXRlLCBldmVudCk7IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6IFwicmVxdWlyZS1uZXctcGFzc3dvcmQtXCIgKyBhdHRyaWJ1dGUgKyBcIi1pbnB1dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubmV3Rm9ybUZpZWxkcyA9IF9fc3ByZWFkQXJyYXlzKF90aGlzLm5ld0Zvcm1GaWVsZHMsIFtmb3JtRmllbGRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGFzc180LnByb3RvdHlwZS5jb21wb25lbnRXaWxsTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q3VycmVudFVzZXIoKTtcbiAgICB9O1xuICAgIGNsYXNzXzQucHJvdG90eXBlLmhhbmRsZVBhc3N3b3JkQ2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucGFzc3dvcmQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgfTtcbiAgICBjbGFzc180LnByb3RvdHlwZS5mb3JtYXRQaG9uZU51bWJlciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBoYW5kbGVQaG9uZU51bWJlckNoYW5nZShldmVudCwgdGhpcy5waG9uZU51bWJlcik7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCB3aWxsIHRocm93IGFuIGVycm9yIGlmIHRoZSBwaG9uZU51bWJlclZhbHVlIGl0IHJlY2VpdmVzXG4gICAgICAgICAqIGlzIGVtcHR5LiBBZGRpbmcgYSBjaGVjayBoZXJlIHRvIHRyeSBhbmQgbWFrZSBzdXJlIHRoYXQgZG9lc24ndCBoYXBwZW4uLi5idXQgd2lsbFxuICAgICAgICAgKiB3cmFwIGl0IGluIGEgdHJ5L2NhdGNoIGJsb2NrIGp1c3QgaW4gY2FzZSBhcyB3ZWxsXG4gICAgICAgICAqL1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09PSBQSE9ORV9TVUZGSVggJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcG9zZWRJbnB1dCA9IGNvbXBvc2VQaG9uZU51bWJlcklucHV0KHRoaXMucGhvbmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVxdWlyZWRBdHRyaWJ1dGVzWydwaG9uZV9udW1iZXInXSA9IGNvbXBvc2VkSW5wdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgbG9nZ2VyJDEuZXJyb3IoXCJlcnJvciBpbiBwaG9uZSBudW1iZXIgZmllbGQgLSBcIiArIGVycik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzQucHJvdG90eXBlLmNvbXBsZXRlTmV3UGFzc3dvcmQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHVzZXIsIF9hLCBlcnJvcl83O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5jb21wbGV0ZU5ld1Bhc3N3b3JkICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgOCwgOSwgMTBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguY29tcGxldGVOZXdQYXNzd29yZCh0aGlzLmN1cnJlbnRVc2VyLCB0aGlzLnBhc3N3b3JkLCB0aGlzLnJlcXVpcmVkQXR0cmlidXRlcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDEuZGVidWcoJ2NvbXBsZXRlIG5ldyBwYXNzd29yZCcsIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB1c2VyLmNoYWxsZW5nZU5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDaGFsbGVuZ2VOYW1lLlNNU01GQTogcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDaGFsbGVuZ2VOYW1lLk1GQVNldHVwOiByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuQ29uZmlybVNpZ25JbiwgdXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDEuZGVidWcoJ1RPVFAgc2V0dXAnLCB1c2VyLmNoYWxsZW5nZVBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5UT1RQU2V0dXAsIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFs0IC8qeWllbGQqLywgY2hlY2tDb250YWN0KHVzZXIsIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzcgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfNyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNsYXNzXzQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhlYWRlclRleHQ6IEkxOG4uZ2V0KHRoaXMuaGVhZGVyVGV4dCksIGhhbmRsZVN1Ym1pdDogdGhpcy5oYW5kbGVTdWJtaXQsIGxvYWRpbmc6IHRoaXMubG9hZGluZywgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pOyB9IH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5CQUNLX1RPX1NJR05fSU4pKSwgc3VibWl0QnV0dG9uVGV4dDogSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSB9LCBoKFwiYW1wbGlmeS1hdXRoLWZpZWxkc1wiLCB7IGZvcm1GaWVsZHM6IHRoaXMubmV3Rm9ybUZpZWxkcyB9KSkpKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbGFzc180LCBcIndhdGNoZXJzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFwidXNlclwiOiBbXCJ1c2VySGFuZGxlclwiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBjbGFzc180O1xufSgpKTtcbnZhciBhbXBsaWZ5U2lnbkluQ3NzID0gXCI6aG9zdHstLWZvb3Rlci1zaXplOnZhcigtLWFtcGxpZnktdGV4dC1zbSk7LS1mb290ZXItY29sb3I6dmFyKC0tYW1wbGlmeS1ncmV5KTstLWZvb3Rlci1mb250LWZhbWlseTp2YXIoLS1hbXBsaWZ5LWZvbnQtZmFtaWx5KTstLWZvbnQtd2VpZ2h0OnZhcigtLWFtcGxpZnktZm9udC13ZWlnaHQpfS5zaWduLWluLWZvcm0tZm9vdGVye2ZvbnQtZmFtaWx5OnZhcigtLWZvb3Rlci1mb250LWZhbWlseSk7Zm9udC1zaXplOnZhcigtLWZvb3Rlci1zaXplKTtjb2xvcjp2YXIoLS1mb290ZXItY29sb3IpO2ZvbnQtd2VpZ2h0Oi0tZm9udC13ZWlnaHQ7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbi1yZXZlcnNlO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbi1yZXZlcnNlOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LW1zLWZsZXgtcGFjazpkaXN0cmlidXRlO2p1c3RpZnktY29udGVudDpzcGFjZS1hcm91bmR9LnNpZ24taW4tZm9ybS1mb290ZXIgYW1wbGlmeS1idXR0b257bWFyZ2luLWJvdHRvbTowLjYyNXJlbX1AbWVkaWEgKG1pbi13aWR0aDogNjcycHgpey5zaWduLWluLWZvcm0tZm9vdGVye2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy1tcy1mbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC1kaXJlY3Rpb246cm93Oy1tcy1mbGV4LXBhY2s6anVzdGlmeTtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjstbXMtZmxleC1hbGlnbjpiYXNlbGluZTthbGlnbi1pdGVtczpiYXNlbGluZX0uc2lnbi1pbi1mb3JtLWZvb3RlciBhbXBsaWZ5LWJ1dHRvbnttYXJnaW4tYm90dG9tOjB9fS5zaWduLWluLWZvcm0tZm9vdGVyICorKnttYXJnaW4tYm90dG9tOjE1cHh9LmZ1bGwtd2lkdGgtZm9vdGVyLWNvbnRlbnR7d2lkdGg6MTAwJX1cIjtcbnZhciBBbXBsaWZ5U2lnbkluID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzUoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBzaWduIGluIGZvcm0gaXMgc3VibWl0dGVkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5zaWduSW4oZXZlbnQpOyB9O1xuICAgICAgICAvKiogVXNlZCBmb3IgaGVhZGVyIHRleHQgaW4gc2lnbiBpbiBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLlNJR05fSU5fSEVBREVSX1RFWFQ7XG4gICAgICAgIC8qKiBVc2VkIGZvciB0aGUgc3VibWl0IGJ1dHRvbiB0ZXh0IGluIHNpZ24gaW4gY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5TSUdOX0lOX0FDVElPTjtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50ICovXG4gICAgICAgIC8vIHByZXR0aWVyLWlnbm9yZVxuICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSA9IGRpc3BhdGNoQXV0aFN0YXRlQ2hhbmdlRXZlbnQ7XG4gICAgICAgIC8qKiBVc2VybmFtZSBBbGlhcyBpcyB1c2VkIHRvIHNldHVwIGF1dGhlbnRpY2F0aW9uIHdpdGggYHVzZXJuYW1lYCwgYGVtYWlsYCBvciBgcGhvbmVfbnVtYmVyYCAgKi9cbiAgICAgICAgdGhpcy51c2VybmFtZUFsaWFzID0gJ3VzZXJuYW1lJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZvcm0gZmllbGRzIGFsbG93cyB5b3UgdG8gdXRpbGl6ZSBvdXIgcHJlLWJ1aWx0IGNvbXBvbmVudHMgc3VjaCBhcyB1c2VybmFtZSBmaWVsZCwgY29kZSBmaWVsZCwgcGFzc3dvcmQgZmllbGQsIGVtYWlsIGZpZWxkLCBldGMuXG4gICAgICAgICAqIGJ5IHBhc3NpbmcgYW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IHlvdSB3b3VsZCBsaWtlIHRoZSBvcmRlciBvZiB0aGUgZm9ybSB0byBiZSBpbi4gSWYgeW91IG5lZWQgbW9yZSBjdXN0b21pemF0aW9uLCBzdWNoIGFzIGNoYW5naW5nXG4gICAgICAgICAqIHRleHQgZm9yIGEgbGFiZWwgb3IgYWRqdXN0IGEgcGxhY2Vob2xkZXIsIHlvdSBjYW4gZm9sbG93IHRoZSBzdHJ1Y3R1cmUgYmVsb3cgaW4gb3JkZXIgdG8gZG8ganVzdCB0aGF0LlxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogW1xuICAgICAgICAgKiAge1xuICAgICAgICAgKiAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgICAgICAqICAgIHBsYWNlaG9sZGVyOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGhpbnQ6IHN0cmluZyB8IEZ1bmN0aW9uYWwgQ29tcG9uZW50IHwgbnVsbCxcbiAgICAgICAgICogICAgcmVxdWlyZWQ6IGJvb2xlYW5cbiAgICAgICAgICogIH1cbiAgICAgICAgICogXVxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICAvKiogSGlkZXMgdGhlIHNpZ24gdXAgbGluayAqL1xuICAgICAgICB0aGlzLmhpZGVTaWduVXAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW107XG4gICAgICAgIC8qIFdoZXRoZXIgb3Igbm90IHRoZSBzaWduLWluIGNvbXBvbmVudCBpcyBsb2FkaW5nICovXG4gICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0ge1xuICAgICAgICAgICAgY291bnRyeURpYWxDb2RlVmFsdWU6IENPVU5UUllfRElBTF9DT0RFX0RFRkFVTFQsXG4gICAgICAgICAgICBwaG9uZU51bWJlclZhbHVlOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNpZ25JbkF0dHJpYnV0ZXMgPSB7XG4gICAgICAgICAgICB1c2VySW5wdXQ6ICcnLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjbGFzc181LnByb3RvdHlwZS5jb21wb25lbnRXaWxsTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hlY2tVc2VybmFtZUFsaWFzKHRoaXMudXNlcm5hbWVBbGlhcyk7XG4gICAgICAgIHRoaXMuYnVpbGRGb3JtRmllbGRzKCk7XG4gICAgfTtcbiAgICBjbGFzc181LnByb3RvdHlwZS5mb3JtRmllbGRzSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5idWlsZEZvcm1GaWVsZHMoKTtcbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlID0gZnVuY3Rpb24gKGZpZWxkVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5zaWduSW5BdHRyaWJ1dGVzLnVzZXJJbnB1dCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIGhhbmRsZVBob25lTnVtYmVyQ2hhbmdlKGV2ZW50LCBfdGhpcy5waG9uZU51bWJlcik7IH07XG4gICAgICAgICAgICBjYXNlICdwYXNzd29yZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLnNpZ25JbkF0dHJpYnV0ZXMucGFzc3dvcmQgPSBldmVudC50YXJnZXQudmFsdWUpOyB9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc181LnByb3RvdHlwZS5oYW5kbGVGb3JtRmllbGRJbnB1dFdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uIChldmVudCwgZmllbGQpIHtcbiAgICAgICAgdmFyIGZuVG9DYWxsID0gZmllbGRbJ2hhbmRsZUlucHV0Q2hhbmdlJ11cbiAgICAgICAgICAgID8gZmllbGRbJ2hhbmRsZUlucHV0Q2hhbmdlJ11cbiAgICAgICAgICAgIDogZnVuY3Rpb24gKGV2ZW50LCBjYikge1xuICAgICAgICAgICAgICAgIGNiKGV2ZW50KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoZmllbGQudHlwZSk7XG4gICAgICAgIGZuVG9DYWxsKGV2ZW50LCBjYWxsYmFjay5iaW5kKHRoaXMpKTtcbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLnNpZ25JbiA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlcm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdm9pZCBzdWJtaXR0aW5nIHRoZSBmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpcy51c2VybmFtZUFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbkluQXR0cmlidXRlcy51c2VySW5wdXQgPSBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCh0aGlzLnBob25lTnVtYmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gdGhpcy5zaWduSW5BdHRyaWJ1dGVzLnVzZXJJbnB1dC50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoYW5kbGVTaWduSW4odXNlcm5hbWUsIHRoaXMuc2lnbkluQXR0cmlidXRlcy5wYXNzd29yZCwgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UsIHRoaXMudXNlcm5hbWVBbGlhcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGFzc181LnByb3RvdHlwZS5idWlsZERlZmF1bHRGb3JtRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZm9ybUZpZWxkSW5wdXRzID0gW107XG4gICAgICAgIHN3aXRjaCAodGhpcy51c2VybmFtZUFsaWFzKSB7XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgZm9ybUZpZWxkSW5wdXRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ2VtYWlsJyksXG4gICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi1pbi1lbWFpbC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIGZvcm1GaWVsZElucHV0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bob25lX251bWJlcicsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGhvbmVfbnVtYmVyJyksXG4gICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi1pbi1waG9uZS1udW1iZXItaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlOiAndXNlcm5hbWUnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBmb3JtRmllbGRJbnB1dHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgndXNlcm5hbWUnKSxcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLWluLXVzZXJuYW1lLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ3VzZXJuYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBmb3JtRmllbGRJbnB1dHMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgaGludDogKGgoXCJkaXZcIiwgbnVsbCwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkZPUkdPVF9QQVNTV09SRF9URVhUKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLkZvcmdvdFBhc3N3b3JkKTsgfSwgXCJkYXRhLXRlc3RcIjogXCJzaWduLWluLWZvcmdvdC1wYXNzd29yZC1saW5rXCIgfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLlJFU0VUX1BBU1NXT1JEX1RFWFQpKSkpLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGFzc3dvcmQnKSxcbiAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24taW4tcGFzc3dvcmQtaW5wdXQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IF9fc3ByZWFkQXJyYXlzKGZvcm1GaWVsZElucHV0cyk7XG4gICAgfTtcbiAgICBjbGFzc181LnByb3RvdHlwZS5idWlsZEZvcm1GaWVsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmZvcm1GaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRGVmYXVsdEZvcm1GaWVsZHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBuZXdGaWVsZHNfMyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5mb3JtRmllbGRzLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0ZpZWxkID0gT2JqZWN0LmFzc2lnbih7fSwgZmllbGQpO1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IGhhbmRsZSBoaW50IGJldHRlclxuICAgICAgICAgICAgICAgIGlmIChuZXdGaWVsZC50eXBlID09PSAncGFzc3dvcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkWydoaW50J10gPSBpc0hpbnRWYWxpZChuZXdGaWVsZCkgPyAoaChcImRpdlwiLCBudWxsLCBJMThuLmdldChUcmFuc2xhdGlvbnMuRk9SR09UX1BBU1NXT1JEX1RFWFQpLCAnICcsIGgoXCJhbXBsaWZ5LWJ1dHRvblwiLCB7IHZhcmlhbnQ6IFwiYW5jaG9yXCIsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuRm9yZ290UGFzc3dvcmQpOyB9LCBcImRhdGEtdGVzdFwiOiBcInNpZ24taW4tZm9yZ290LXBhc3N3b3JkLWxpbmtcIiB9LCBJMThuLmdldChUcmFuc2xhdGlvbnMuUkVTRVRfUEFTU1dPUkRfVEVYVCkpKSkgOiAobmV3RmllbGRbJ2hpbnQnXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dFdpdGhDYWxsYmFjayhldmVudCwgZmllbGQpOyB9O1xuICAgICAgICAgICAgICAgIF90aGlzLnNldEZpZWxkVmFsdWUobmV3RmllbGQsIF90aGlzLnNpZ25JbkF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkc18zLnB1c2gobmV3RmllbGQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBuZXdGaWVsZHNfMztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUuc2V0RmllbGRWYWx1ZSA9IGZ1bmN0aW9uIChmaWVsZCwgZm9ybUF0dHJpYnV0ZXMpIHtcbiAgICAgICAgc3dpdGNoIChmaWVsZC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcklucHV0ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlcy51c2VySW5wdXQgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC5kaWFsQ29kZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLmNvdW50cnlEaWFsQ29kZVZhbHVlID0gZmllbGQuZGlhbENvZGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucGhvbmVOdW1iZXIucGhvbmVOdW1iZXJWYWx1ZSA9IGZpZWxkLnZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGFzc3dvcmQnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnBhc3N3b3JkID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlcy5wYXNzd29yZCA9IGZpZWxkLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGVhZGVyVGV4dDogSTE4bi5nZXQodGhpcy5oZWFkZXJUZXh0KSwgaGFuZGxlU3VibWl0OiB0aGlzLmhhbmRsZVN1Ym1pdCwgdGVzdERhdGFQcmVmaXg6ICdzaWduLWluJyB9LCBoKFwiZGl2XCIsIHsgc2xvdDogXCJzdWJ0aXRsZVwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJoZWFkZXItc3VidGl0bGVcIiB9KSksIGgoXCJzbG90XCIsIHsgbmFtZTogXCJmZWRlcmF0ZWQtYnV0dG9uc1wiIH0sIGgoXCJhbXBsaWZ5LWZlZGVyYXRlZC1idXR0b25zXCIsIHsgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlOiB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSwgZmVkZXJhdGVkOiB0aGlzLmZlZGVyYXRlZCB9KSksICFpc0VtcHR5KHRoaXMuZmVkZXJhdGVkKSAmJiBoKFwiYW1wbGlmeS1zdHJpa2VcIiwgbnVsbCwgXCJvclwiKSwgaChcImFtcGxpZnktYXV0aC1maWVsZHNcIiwgeyBmb3JtRmllbGRzOiB0aGlzLm5ld0Zvcm1GaWVsZHMgfSksIGgoXCJkaXZcIiwgeyBzbG90OiBcImFtcGxpZnktZm9ybS1zZWN0aW9uLWZvb3RlclwiLCBjbGFzczogXCJzaWduLWluLWZvcm0tZm9vdGVyXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImZvb3RlclwiIH0sICF0aGlzLmhpZGVTaWduVXAgJiYgKGgoXCJzbG90XCIsIHsgbmFtZTogXCJzZWNvbmRhcnktZm9vdGVyLWNvbnRlbnRcIiB9LCBoKFwic3BhblwiLCBudWxsLCBJMThuLmdldChUcmFuc2xhdGlvbnMuTk9fQUNDT1VOVF9URVhUKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25VcCk7IH0sIFwiZGF0YS10ZXN0XCI6IFwic2lnbi1pbi1jcmVhdGUtYWNjb3VudC1saW5rXCIgfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkNSRUFURV9BQ0NPVU5UX1RFWFQpKSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiB0aGlzLmhpZGVTaWduVXAgPyAnZnVsbC13aWR0aC1mb290ZXItY29udGVudCcgOiAnJyB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwicHJpbWFyeS1mb290ZXItY29udGVudFwiIH0sIGgoXCJhbXBsaWZ5LWJ1dHRvblwiLCB7IHR5cGU6IFwic3VibWl0XCIsIGRpc2FibGVkOiB0aGlzLmxvYWRpbmcsIFwiZGF0YS10ZXN0XCI6IFwic2lnbi1pbi1zaWduLWluLWJ1dHRvblwiIH0sIHRoaXMubG9hZGluZyA/IChoKFwiYW1wbGlmeS1sb2FkaW5nLXNwaW5uZXJcIiwgbnVsbCkpIDogKGgoXCJzcGFuXCIsIG51bGwsIEkxOG4uZ2V0KHRoaXMuc3VibWl0QnV0dG9uVGV4dCkpKSkpKSkpKSkpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzXzUsIFwid2F0Y2hlcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgXCJmb3JtRmllbGRzXCI6IFtcImZvcm1GaWVsZHNIYW5kbGVyXCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGNsYXNzXzU7XG59KCkpO1xuQW1wbGlmeVNpZ25Jbi5zdHlsZSA9IGFtcGxpZnlTaWduSW5Dc3M7XG52YXIgYW1wbGlmeVNpZ25VcENzcyA9IFwiYW1wbGlmeS1zaWduLXVwey0tZm9vdGVyLWZvbnQtZmFtaWx5OnZhcigtLWFtcGxpZnktZm9udC1mYW1pbHkpOy0tZm9vdGVyLWZvbnQtc2l6ZTp2YXIoLS1hbXBsaWZ5LXRleHQtc20pOy0tZm9vdGVyLWNvbG9yOnZhcigtLWFtcGxpZnktZ3JleSk7LS1mb250LXdlaWdodDp2YXIoLS1hbXBsaWZ5LWZvbnQtd2VpZ2h0KX0uc2lnbi11cC1mb3JtLWZvb3Rlcntmb250LWZhbWlseTp2YXIoLS1mb290ZXItZm9udC1mYW1pbHkpO2ZvbnQtc2l6ZTp2YXIoLS1mb290ZXItZm9udC1zaXplKTtjb2xvcjp2YXIoLS1mb290ZXItY29sb3IpO2ZvbnQtd2VpZ2h0Oi0tZm9udC13ZWlnaHQ7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbi1yZXZlcnNlO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbi1yZXZlcnNlOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LW1zLWZsZXgtcGFjazpkaXN0cmlidXRlO2p1c3RpZnktY29udGVudDpzcGFjZS1hcm91bmR9LnNpZ24tdXAtZm9ybS1mb290ZXIgYW1wbGlmeS1idXR0b257bWFyZ2luLWJvdHRvbTowLjYyNXJlbX1AbWVkaWEgKG1pbi13aWR0aDogNjcycHgpey5zaWduLXVwLWZvcm0tZm9vdGVye2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy1tcy1mbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC1kaXJlY3Rpb246cm93Oy1tcy1mbGV4LXBhY2s6anVzdGlmeTtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjstbXMtZmxleC1hbGlnbjpiYXNlbGluZTthbGlnbi1pdGVtczpiYXNlbGluZX0uc2lnbi11cC1mb3JtLWZvb3RlciBhbXBsaWZ5LWJ1dHRvbnttYXJnaW4tYm90dG9tOjB9fS5zaWduLXVwLWZvcm0tZm9vdGVyICorKnttYXJnaW4tYm90dG9tOjE1cHh9XCI7XG52YXIgQW1wbGlmeVNpZ25VcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc182KGhvc3RSZWYpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgLyoqIEZpcmVzIHdoZW4gc2lnbiB1cCBmb3JtIGlzIHN1Ym1pdHRlZCAqL1xuICAgICAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuc2lnblVwKGV2ZW50KTsgfTtcbiAgICAgICAgLyoqIE92ZXJyaWRlIGZvciBoYW5kbGluZyB0aGUgQXV0aC5TaWduVXAgQVBJIGNhbGwgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTaWduVXAgPSBmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiBfdGhpcy5hdXRoU2lnblVwKHBhcmFtcyk7IH07XG4gICAgICAgIC8qKiBVc2VkIGZvciBoZWFkZXIgdGV4dCBpbiBzaWduIHVwIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLmhlYWRlclRleHQgPSBUcmFuc2xhdGlvbnMuU0lHTl9VUF9IRUFERVJfVEVYVDtcbiAgICAgICAgLyoqIFVzZWQgZm9yIHRoZSBzdWJtaXQgYnV0dG9uIHRleHQgaW4gc2lnbiB1cCBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b25UZXh0ID0gVHJhbnNsYXRpb25zLlNJR05fVVBfU1VCTUlUX0JVVFRPTl9URVhUO1xuICAgICAgICAvKiogVXNlZCBmb3IgdGhlIHN1Ym1pdCBidXR0b24gdGV4dCBpbiBzaWduIHVwIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLmhhdmVBY2NvdW50VGV4dCA9IFRyYW5zbGF0aW9ucy5TSUdOX1VQX0hBVkVfQUNDT1VOVF9URVhUO1xuICAgICAgICAvKiogVGV4dCB1c2VkIGZvciB0aGUgc2lnbiBpbiBoeXBlcmxpbmsgKi9cbiAgICAgICAgdGhpcy5zaWduSW5UZXh0ID0gVHJhbnNsYXRpb25zLlNJR05fSU5fVEVYVDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZvcm0gZmllbGRzIGFsbG93cyB5b3UgdG8gdXRpbGl6ZSBvdXIgcHJlLWJ1aWx0IGNvbXBvbmVudHMgc3VjaCBhcyB1c2VybmFtZSBmaWVsZCwgY29kZSBmaWVsZCwgcGFzc3dvcmQgZmllbGQsIGVtYWlsIGZpZWxkLCBldGMuXG4gICAgICAgICAqIGJ5IHBhc3NpbmcgYW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IHlvdSB3b3VsZCBsaWtlIHRoZSBvcmRlciBvZiB0aGUgZm9ybSB0byBiZSBpbi4gSWYgeW91IG5lZWQgbW9yZSBjdXN0b21pemF0aW9uLCBzdWNoIGFzIGNoYW5naW5nXG4gICAgICAgICAqIHRleHQgZm9yIGEgbGFiZWwgb3IgYWRqdXN0IGEgcGxhY2Vob2xkZXIsIHlvdSBjYW4gZm9sbG93IHRoZSBzdHJ1Y3R1cmUgYmVsb3cgaW4gb3JkZXIgdG8gZG8ganVzdCB0aGF0LlxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogW1xuICAgICAgICAgKiAge1xuICAgICAgICAgKiAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgICAgICAqICAgIHBsYWNlaG9sZGVyOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGhpbnQ6IHN0cmluZyB8IEZ1bmN0aW9uYWwgQ29tcG9uZW50IHwgbnVsbCxcbiAgICAgICAgICogICAgcmVxdWlyZWQ6IGJvb2xlYW5cbiAgICAgICAgICogIH1cbiAgICAgICAgICogXVxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICAvKiogQXV0aCBzdGF0ZSBjaGFuZ2UgaGFuZGxlciBmb3IgdGhpcyBjb21wb25lbnRcbiAgICAgICAgICogZS5nLiBTaWduSW4gLT4gJ0NyZWF0ZSBBY2NvdW50JyBsaW5rIC0+IFNpZ25VcFxuICAgICAgICAgKi9cbiAgICAgICAgLy8gcHJldHRpZXItaWdub3JlXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIFVzZXJuYW1lIEFsaWFzIGlzIHVzZWQgdG8gc2V0dXAgYXV0aGVudGljYXRpb24gd2l0aCBgdXNlcm5hbWVgLCBgZW1haWxgIG9yIGBwaG9uZV9udW1iZXJgICAqL1xuICAgICAgICB0aGlzLnVzZXJuYW1lQWxpYXMgPSAndXNlcm5hbWUnO1xuICAgICAgICAvLyBwcml2YXRlIHVzZXJJbnB1dDogc3RyaW5nIHwgUGhvbmVOdW1iZXJJbnRlcmZhY2U7XG4gICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0ge1xuICAgICAgICAgICAgY291bnRyeURpYWxDb2RlVmFsdWU6IENPVU5UUllfRElBTF9DT0RFX0RFRkFVTFQsXG4gICAgICAgICAgICBwaG9uZU51bWJlclZhbHVlOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zaWduVXBBdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6ICcnLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzYucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlID0gZnVuY3Rpb24gKGZpZWxkVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5zaWduVXBBdHRyaWJ1dGVzLnVzZXJuYW1lID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiAoX3RoaXMuc2lnblVwQXR0cmlidXRlcy5wYXNzd29yZCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLnNpZ25VcEF0dHJpYnV0ZXMuYXR0cmlidXRlcy5lbWFpbCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIGhhbmRsZVBob25lTnVtYmVyQ2hhbmdlKGV2ZW50LCBfdGhpcy5waG9uZU51bWJlcik7IH07XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5zaWduVXBBdHRyaWJ1dGVzLmF0dHJpYnV0ZXNbZmllbGRUeXBlXSA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzYucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBmaWVsZCkge1xuICAgICAgICB2YXIgZm5Ub0NhbGwgPSBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgPyBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgOiBmdW5jdGlvbiAoZXZlbnQsIGNiKSB7XG4gICAgICAgICAgICAgICAgY2IoZXZlbnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZShmaWVsZC50eXBlKTtcbiAgICAgICAgZm5Ub0NhbGwoZXZlbnQsIGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuYXV0aFNpZ25VcCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguc2lnblVwKHBhcmFtcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFRyYW5zbGF0aW9ucy5TSUdOX1VQX0ZBSUxFRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZGF0YV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuYXNzaWduUGhvbmVOdW1iZXJUb1NpZ25VcEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaWduVXBBdHRyaWJ1dGVzLmF0dHJpYnV0ZXMucGhvbmVfbnVtYmVyID0gY29tcG9zZVBob25lTnVtYmVySW5wdXQodGhpcy5waG9uZU51bWJlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5hc3NpZ25Vc2VyTmFtZUFsaWFzVG9TaWduVXBBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMudXNlcm5hbWVBbGlhcykge1xuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMudXNlcm5hbWUgPSB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMuYXR0cmlidXRlc1t0aGlzLnVzZXJuYW1lQWxpYXNdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5hc3NpZ25Gb3JtSW5wdXRUb1NpZ25VcEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYXNzaWduUGhvbmVOdW1iZXJUb1NpZ25VcEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgdGhpcy5hc3NpZ25Vc2VyTmFtZUFsaWFzVG9TaWduVXBBdHRyaWJ1dGVzKCk7XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS52YWxpZGF0ZVNpZ25VcEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5zaWduVXBBdHRyaWJ1dGVzLnVzZXJuYW1lKSB7XG4gICAgICAgICAgICBpZiAodGhpcy51c2VybmFtZUFsaWFzID09PSBVc2VybmFtZUFsaWFzLmVtYWlsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFRyYW5zbGF0aW9ucy5FTVBUWV9FTUFJTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnVzZXJuYW1lQWxpYXMgPT09IFVzZXJuYW1lQWxpYXMucGhvbmVfbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFRyYW5zbGF0aW9ucy5FTVBUWV9QSE9ORSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoVHJhbnNsYXRpb25zLkVNUFRZX1VTRVJOQU1FKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaWduVXBBdHRyaWJ1dGVzLnVzZXJuYW1lLmluZGV4T2YoJyAnKSA+PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoVHJhbnNsYXRpb25zLlVTRVJOQU1FX1JFTU9WRV9XSElURVNQQUNFKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaWduVXBBdHRyaWJ1dGVzLnBhc3N3b3JkICE9PSB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMucGFzc3dvcmQudHJpbSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoVHJhbnNsYXRpb25zLlBBU1NXT1JEX1JFTU9WRV9XSElURVNQQUNFKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gVE9ETzogQWRkIHZhbGlkYXRpb25cbiAgICAvLyBUT0RPOiBQcmVmaXhcbiAgICBjbGFzc182LnByb3RvdHlwZS5zaWduVXAgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGEsIHNpZ25VcEF0dHJzLCBlcnJvcl84O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5zaWduVXAgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzaWduRm9ybUlucHV0VG9TaWduVXBBdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNiwgNywgOF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVNpZ25VcEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaGFuZGxlU2lnblVwKHRoaXMuc2lnblVwQXR0cmlidXRlcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhLnVzZXJDb25maXJtZWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgaGFuZGxlU2lnbkluKHRoaXMuc2lnblVwQXR0cmlidXRlcy51c2VybmFtZSwgdGhpcy5zaWduVXBBdHRyaWJ1dGVzLnBhc3N3b3JkLCB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnblVwQXR0cnMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLkNvbmZpcm1TaWduVXAsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZGF0YS51c2VyKSwgeyBzaWduVXBBdHRyczogc2lnblVwQXR0cnMgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl84ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfRU1BSUxfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnZW1haWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtZW1haWwtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ3VzZXJuYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfUEFTU1dPUkRfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGFzc3dvcmQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtcGFzc3dvcmQtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ25ldy1wYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGhvbmVfbnVtYmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bob25lX251bWJlcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi11cC1waG9uZS1udW1iZXItaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ3RlbC1uYXRpb25hbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bob25lX251bWJlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwaG9uZV9udW1iZXInKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtcGhvbmUtbnVtYmVyLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5TSUdOX1VQX1BBU1NXT1JEX1BMQUNFSE9MREVSKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bhc3N3b3JkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLXBhc3N3b3JkLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICduZXctcGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtYWlsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuU0lHTl9VUF9FTUFJTF9QTEFDRUhPTERFUiksXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdlbWFpbCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi11cC1lbWFpbC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfVVNFUk5BTUVfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgndXNlcm5hbWUnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtdXNlcm5hbWUtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ3VzZXJuYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfUEFTU1dPUkRfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGFzc3dvcmQnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtcGFzc3dvcmQtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZTogJ25ldy1wYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5TSUdOX1VQX0VNQUlMX1BMQUNFSE9MREVSKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ2VtYWlsJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLWVtYWlsLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwaG9uZV9udW1iZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGhvbmVfbnVtYmVyJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLXBob25lLW51bWJlci1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzYucHJvdG90eXBlLmJ1aWxkRm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuZm9ybUZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5ld0ZpZWxkc180ID0gW107XG4gICAgICAgICAgICB0aGlzLmZvcm1GaWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3RmllbGQgPSBPYmplY3QuYXNzaWduKHt9LCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRbJ2hhbmRsZUlucHV0Q2hhbmdlJ10gPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrKGV2ZW50LCBmaWVsZCk7IH07XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0RmllbGRWYWx1ZShmaWVsZCwgX3RoaXMuc2lnblVwQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRzXzQucHVzaChuZXdGaWVsZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IG5ld0ZpZWxkc180O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5zZXRGaWVsZFZhbHVlID0gZnVuY3Rpb24gKGZpZWxkLCBmb3JtQXR0cmlidXRlcykge1xuICAgICAgICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlcy51c2VybmFtZSA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcm5hbWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwYXNzd29yZCc6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMucGFzc3dvcmQgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnBhc3N3b3JkID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLmF0dHJpYnV0ZXMuZW1haWwgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLmRpYWxDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGhvbmVOdW1iZXIuY291bnRyeURpYWxDb2RlVmFsdWUgPSBmaWVsZC5kaWFsQ29kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5waG9uZU51bWJlclZhbHVlID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLmF0dHJpYnV0ZXNbZmllbGQudHlwZV0gPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrVXNlcm5hbWVBbGlhcyh0aGlzLnVzZXJuYW1lQWxpYXMpO1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuZm9ybUZpZWxkc0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYnVpbGRGb3JtRmllbGRzKCk7XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoaChIb3N0LCBudWxsLCBoKFwiYW1wbGlmeS1mb3JtLXNlY3Rpb25cIiwgeyBoZWFkZXJUZXh0OiBJMThuLmdldCh0aGlzLmhlYWRlclRleHQpLCBoYW5kbGVTdWJtaXQ6IHRoaXMuaGFuZGxlU3VibWl0LCB0ZXN0RGF0YVByZWZpeDogJ3NpZ24tdXAnIH0sIGgoXCJkaXZcIiwgeyBzbG90OiBcInN1YnRpdGxlXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImhlYWRlci1zdWJ0aXRsZVwiIH0pKSwgaChcImFtcGxpZnktYXV0aC1maWVsZHNcIiwgeyBmb3JtRmllbGRzOiB0aGlzLm5ld0Zvcm1GaWVsZHMgfSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJzaWduLXVwLWZvcm0tZm9vdGVyXCIsIHNsb3Q6IFwiYW1wbGlmeS1mb3JtLXNlY3Rpb24tZm9vdGVyXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImZvb3RlclwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJzZWNvbmRhcnktZm9vdGVyLWNvbnRlbnRcIiB9LCBoKFwic3BhblwiLCBudWxsLCBJMThuLmdldCh0aGlzLmhhdmVBY2NvdW50VGV4dCksICcgJywgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pOyB9LCBcImRhdGEtdGVzdFwiOiBcInNpZ24tdXAtc2lnbi1pbi1saW5rXCIgfSwgSTE4bi5nZXQodGhpcy5zaWduSW5UZXh0KSkpKSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInByaW1hcnktZm9vdGVyLWNvbnRlbnRcIiB9LCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB0eXBlOiBcInN1Ym1pdFwiLCBcImRhdGEtdGVzdFwiOiBcInNpZ24tdXAtY3JlYXRlLWFjY291bnQtYnV0dG9uXCIsIGRpc2FibGVkOiB0aGlzLmxvYWRpbmcgfSwgdGhpcy5sb2FkaW5nID8gKGgoXCJhbXBsaWZ5LWxvYWRpbmctc3Bpbm5lclwiLCBudWxsKSkgOiAoaChcInNwYW5cIiwgbnVsbCwgSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSkpKSkpKSkpKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbGFzc182LCBcIndhdGNoZXJzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFwiZm9ybUZpZWxkc1wiOiBbXCJmb3JtRmllbGRzSGFuZGxlclwiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBjbGFzc182O1xufSgpKTtcbkFtcGxpZnlTaWduVXAuc3R5bGUgPSBhbXBsaWZ5U2lnblVwQ3NzO1xudmFyIGxvZ2dlciQyID0gbmV3IExvZ2dlcignQW1wbGlmeVZlcmlmeUNvbnRhY3QnKTtcbnZhciBBbXBsaWZ5VmVyaWZ5Q29udGFjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc183KGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgLyoqIEF1dGhlbnRpY2F0aW9uIHN0YXRlIGhhbmRsZXIgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UgPSBkaXNwYXRjaEF1dGhTdGF0ZUNoYW5nZUV2ZW50O1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgY2xhc3NfNy5wcm90b3R5cGUuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMudmVyaWZ5QXR0ciA/IHRoaXMuc3VibWl0KHRoaXMuY29kZSkgOiB0aGlzLnZlcmlmeSh0aGlzLmNvbnRhY3QpO1xuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUuc3VibWl0ID0gZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGF0dHIsIGRhdGEsIGVycm9yXzk7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyID0gdGhpcy52ZXJpZnlBdHRyO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLnZlcmlmeUN1cnJlbnRVc2VyQXR0cmlidXRlU3VibWl0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgNCwgNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aC52ZXJpZnlDdXJyZW50VXNlckF0dHJpYnV0ZVN1Ym1pdChhdHRyLCBjb2RlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIkMi5kZWJ1ZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduZWRJbiwgdGhpcy51c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmVyaWZ5QXR0ciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfOSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl85KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlciQyLmVycm9yKGVycm9yXzkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUudmVyaWZ5ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGEsIGVycm9yXzEwO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250YWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDIuZXJyb3IoJ05laXRoZXIgRW1haWwgbm9yIFBob25lIE51bWJlciBzZWxlY3RlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC52ZXJpZnlDdXJyZW50VXNlckF0dHJpYnV0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsIDQsIDVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGgudmVyaWZ5Q3VycmVudFVzZXJBdHRyaWJ1dGUoY29udGFjdCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDIuZGVidWcoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZlcmlmeUF0dHIgPSBjb250YWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzEwID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlciQyLmVycm9yKGVycm9yXzEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNsYXNzXzcucHJvdG90eXBlLmhhbmRsZUlucHV0Q2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBpbnB1dE5hbWUgPSBldmVudC50YXJnZXQubmFtZTtcbiAgICAgICAgaWYgKGlucHV0TmFtZSA9PT0gJ2NvZGUnKSB7XG4gICAgICAgICAgICB0aGlzLmNvZGUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXROYW1lID09PSAnY29udGFjdCcpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGFjdCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUucmVuZGVyU3VibWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgbnVsbCwgaChcImFtcGxpZnktaW5wdXRcIiwgeyBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlOiAnb2ZmJyxcbiAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3ZlcmlmeS1jb250YWN0LWNvZGUtaW5wdXQnLFxuICAgICAgICAgICAgfSwgbmFtZTogXCJjb2RlXCIsIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuQ09ERV9QTEFDRUhPTERFUiksIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUlucHV0Q2hhbmdlKGV2ZW50KTsgfSB9KSkpO1xuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUucmVuZGVyVmVyaWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdXNlciA9IHRoaXMudXNlcjtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICBsb2dnZXIkMi5kZWJ1ZygnTm8gdXNlciB0byB2ZXJpZnknKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1bnZlcmlmaWVkID0gdXNlci51bnZlcmlmaWVkO1xuICAgICAgICBpZiAoIXVudmVyaWZpZWQpIHtcbiAgICAgICAgICAgIGxvZ2dlciQyLmRlYnVnKCdVbnZlcmlmaWVkIHZhcmlhYmxlIGRvZXMgbm90IGV4aXN0IG9uIHVzZXInKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbWFpbCA9IHVudmVyaWZpZWQuZW1haWwsIHBob25lX251bWJlciA9IHVudmVyaWZpZWQucGhvbmVfbnVtYmVyO1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgbnVsbCwgZW1haWwgJiYgKGgoXCJhbXBsaWZ5LXJhZGlvLWJ1dHRvblwiLCB7IGxhYmVsOiBJMThuLmdldChUcmFuc2xhdGlvbnMuVkVSSUZZX0NPTlRBQ1RfRU1BSUxfTEFCRUwpLCBrZXk6IFwiZW1haWxcIiwgbmFtZTogXCJjb250YWN0XCIsIHZhbHVlOiBcImVtYWlsXCIsIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUlucHV0Q2hhbmdlKGV2ZW50KTsgfSwgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAndmVyaWZ5LWNvbnRhY3QtZW1haWwtcmFkaW8nLFxuICAgICAgICAgICAgfSB9KSksIHBob25lX251bWJlciAmJiAoaChcImFtcGxpZnktcmFkaW8tYnV0dG9uXCIsIHsgbGFiZWw6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5WRVJJRllfQ09OVEFDVF9QSE9ORV9MQUJFTCksIGtleTogXCJwaG9uZV9udW1iZXJcIiwgbmFtZTogXCJjb250YWN0XCIsIHZhbHVlOiBcInBob25lX251bWJlclwiLCBoYW5kbGVJbnB1dENoYW5nZTogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVJbnB1dENoYW5nZShldmVudCk7IH0sIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3ZlcmlmeS1jb250YWN0LXBob25lLW51bWJlci1yYWRpbycsXG4gICAgICAgICAgICB9IH0pKSkpO1xuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGFuZGxlU3VibWl0OiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZVN1Ym1pdChldmVudCk7IH0sIGhlYWRlclRleHQ6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5WRVJJRllfQ09OVEFDVF9IRUFERVJfVEVYVCksIGxvYWRpbmc6IHRoaXMubG9hZGluZywgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcInNwYW5cIiwgbnVsbCwgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduZWRJbiwgX3RoaXMudXNlcik7IH0sIFwiZGF0YS10ZXN0XCI6IFwidmVyaWZ5LWNvbnRhY3Qtc2tpcC1saW5rXCIgfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNLSVApKSksIHN1Ym1pdEJ1dHRvblRleHQ6IHRoaXMudmVyaWZ5QXR0clxuICAgICAgICAgICAgICAgID8gSTE4bi5nZXQoVHJhbnNsYXRpb25zLlZFUklGWV9DT05UQUNUX1NVQk1JVF9MQUJFTClcbiAgICAgICAgICAgICAgICA6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5WRVJJRllfQ09OVEFDVF9WRVJJRllfTEFCRUwpIH0sIHRoaXMudmVyaWZ5QXR0ciA/IHRoaXMucmVuZGVyU3VibWl0KCkgOiB0aGlzLnJlbmRlclZlcmlmeSgpKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIGNsYXNzXzc7XG59KCkpO1xuZXhwb3J0IHsgQW1wbGlmeUNvbmZpcm1TaWduSW4gYXMgYW1wbGlmeV9jb25maXJtX3NpZ25faW4sIEFtcGxpZnlDb25maXJtU2lnblVwIGFzIGFtcGxpZnlfY29uZmlybV9zaWduX3VwLCBBbXBsaWZ5Rm9yZ290UGFzc3dvcmQgYXMgYW1wbGlmeV9mb3Jnb3RfcGFzc3dvcmQsIEFtcGxpZnlSZXF1aXJlTmV3UGFzc3dvcmQgYXMgYW1wbGlmeV9yZXF1aXJlX25ld19wYXNzd29yZCwgQW1wbGlmeVNpZ25JbiBhcyBhbXBsaWZ5X3NpZ25faW4sIEFtcGxpZnlTaWduVXAgYXMgYW1wbGlmeV9zaWduX3VwLCBBbXBsaWZ5VmVyaWZ5Q29udGFjdCBhcyBhbXBsaWZ5X3ZlcmlmeV9jb250YWN0IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js\n"));

/***/ }),

/***/ "./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-557b83fc.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-557b83fc.js ***!
  \***************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: function() { return /* binding */ checkContact; },\n/* harmony export */   h: function() { return /* binding */ handleSignIn; }\n/* harmony export */ });\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aws-amplify/core */ \"./node_modules/@aws-amplify/core/lib-esm/index.js\");\n/* harmony import */ var _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth-types-78df304e.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-types-78df304e.js\");\n/* harmony import */ var _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-amplify/auth */ \"./node_modules/@aws-amplify/auth/lib-esm/index.js\");\n/* harmony import */ var _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Translations-108d469f.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/Translations-108d469f.js\");\n/* harmony import */ var _constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants-c8ecaa24.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/constants-c8ecaa24.js\");\n/* harmony import */ var _helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helpers-14fcb50c.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/helpers-14fcb50c.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\n\n\n\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__.Logger('auth-helpers');\nfunction checkContact(user, handleAuthStateChange) {\n    return __awaiter(this, void 0, void 0, function () {\n        var data, newUser, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth.verifiedContact !== 'function') {\n                        throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_2__.N);\n                    }\n                    // If `user` is a federated user, we shouldn't call `verifiedContact`\n                    // since `user` isn't `CognitoUser`\n                    if (!isCognitoUser(user)) {\n                        handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.SignedIn, user);\n                        return [2 /*return*/];\n                    }\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth.verifiedContact(user)];\n                case 2:\n                    data = _a.sent();\n                    if (!(0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(data.verified) || (0,_aws_amplify_core__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(data.unverified)) {\n                        handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.SignedIn, user);\n                    }\n                    else {\n                        newUser = Object.assign(user, data);\n                        handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.VerifyContact, newUser);\n                    }\n                    return [3 /*break*/, 4];\n                case 3:\n                    error_1 = _a.sent();\n                    (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_3__.a)(error_1);\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nvar handleSignIn = function (username, password, handleAuthStateChange, usernameAlias) { return __awaiter(void 0, void 0, void 0, function () {\n    var user, error_2;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth.signIn !== 'function') {\n                    throw new Error(_constants_c8ecaa24_js__WEBPACK_IMPORTED_MODULE_2__.N);\n                }\n                _a.label = 1;\n            case 1:\n                _a.trys.push([1, 9, , 10]);\n                return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.Auth.signIn(username, password)];\n            case 2:\n                user = _a.sent();\n                logger.debug(user);\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.C.SMSMFA ||\n                    user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.C.SoftwareTokenMFA)) return [3 /*break*/, 3];\n                logger.debug('confirm user with ' + user.challengeName);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.ConfirmSignIn, user);\n                return [3 /*break*/, 8];\n            case 3:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.C.NewPasswordRequired)) return [3 /*break*/, 4];\n                logger.debug('require new password', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.ResetPassword, user);\n                return [3 /*break*/, 8];\n            case 4:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.C.MFASetup)) return [3 /*break*/, 5];\n                logger.debug('TOTP setup', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.TOTPSetup, user);\n                return [3 /*break*/, 8];\n            case 5:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.C.CustomChallenge &&\n                    user.challengeParam &&\n                    user.challengeParam.trigger === 'true')) return [3 /*break*/, 6];\n                logger.debug('custom challenge', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.CustomConfirmSignIn, user);\n                return [3 /*break*/, 8];\n            case 6: return [4 /*yield*/, checkContact(user, handleAuthStateChange)];\n            case 7:\n                _a.sent();\n                _a.label = 8;\n            case 8: return [3 /*break*/, 10];\n            case 9:\n                error_2 = _a.sent();\n                if (error_2.code === 'UserNotConfirmedException') {\n                    logger.debug('the user is not confirmed');\n                    handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.ConfirmSignUp, { username: username });\n                }\n                else if (error_2.code === 'PasswordResetRequiredException') {\n                    logger.debug('the user requires a new password');\n                    handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.A.ForgotPassword, { username: username });\n                }\n                else if (error_2.code === 'InvalidParameterException' && password === '') {\n                    logger.debug('Password cannot be empty');\n                    error_2.message = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_1__.T.EMPTY_PASSWORD;\n                }\n                else if (error_2.message === _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_1__.T.EMPTY_USERNAME) {\n                    if (usernameAlias === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.U.email) {\n                        error_2.message = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_1__.T.EMPTY_EMAIL;\n                    }\n                    if (usernameAlias === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_0__.U.phone_number) {\n                        error_2.message = _Translations_108d469f_js__WEBPACK_IMPORTED_MODULE_1__.T.EMPTY_PHONE;\n                    }\n                }\n                (0,_helpers_14fcb50c_js__WEBPACK_IMPORTED_MODULE_3__.a)(error_2);\n                return [3 /*break*/, 10];\n            case 10: return [2 /*return*/];\n        }\n    });\n}); };\nvar isCognitoUser = function (user) {\n    return user instanceof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_5__.CognitoUser;\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2F1dGgtaGVscGVycy01NTdiODNmYy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3Qiw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBLG1CQUFtQixTQUFJLElBQUksU0FBSTtBQUMvQixjQUFjLDZCQUE2QiwwQkFBMEIsY0FBYyxxQkFBcUI7QUFDeEcsaUJBQWlCLG9EQUFvRCxxRUFBcUUsY0FBYztBQUN4Six1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QyxtQ0FBbUMsU0FBUztBQUM1QyxtQ0FBbUMsV0FBVyxVQUFVO0FBQ3hELDBDQUEwQyxjQUFjO0FBQ3hEO0FBQ0EsOEdBQThHLE9BQU87QUFDckgsaUZBQWlGLGlCQUFpQjtBQUNsRyx5REFBeUQsZ0JBQWdCLFFBQVE7QUFDakYsK0NBQStDLGdCQUFnQixnQkFBZ0I7QUFDL0U7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBLFVBQVUsWUFBWSxhQUFhLFNBQVMsVUFBVTtBQUN0RCxvQ0FBb0MsU0FBUztBQUM3QztBQUNBO0FBQ29EO0FBQzhDO0FBQzVDO0FBQ1M7QUFDSztBQUNEO0FBQ25FLGlCQUFpQixxREFBTTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsbURBQUksV0FBVyxtREFBSTtBQUM1Qyx3Q0FBd0MscURBQW9CO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFTO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsbURBQUk7QUFDN0M7QUFDQTtBQUNBLHlCQUF5QiwwREFBTyxtQkFBbUIsMERBQU87QUFDMUQsOENBQThDLHNEQUFTO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxzREFBUztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix1REFBcUI7QUFDekM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLHlGQUF5RjtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixtREFBSSxXQUFXLG1EQUFJO0FBQ3hDLG9DQUFvQyxxREFBb0I7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsbURBQUk7QUFDekM7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHNEQUFhO0FBQzFELDJDQUEyQyxzREFBYTtBQUN4RDtBQUNBLHNDQUFzQyxzREFBUztBQUMvQztBQUNBO0FBQ0EsNkNBQTZDLHNEQUFhO0FBQzFEO0FBQ0Esc0NBQXNDLHNEQUFTO0FBQy9DO0FBQ0E7QUFDQSw2Q0FBNkMsc0RBQWE7QUFDMUQ7QUFDQSxzQ0FBc0Msc0RBQVM7QUFDL0M7QUFDQTtBQUNBLDZDQUE2QyxzREFBYTtBQUMxRDtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msc0RBQVM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsc0RBQVMsa0JBQWtCLG9CQUFvQjtBQUN6RjtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsc0RBQVMsbUJBQW1CLG9CQUFvQjtBQUMxRjtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msd0RBQVk7QUFDbEQ7QUFDQSw2Q0FBNkMsd0RBQVk7QUFDekQsMENBQTBDLHNEQUFhO0FBQ3ZELDBDQUEwQyx3REFBWTtBQUN0RDtBQUNBLDBDQUEwQyxzREFBYTtBQUN2RCwwQ0FBMEMsd0RBQVk7QUFDdEQ7QUFDQTtBQUNBLGdCQUFnQix1REFBcUI7QUFDckM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBLDJCQUEyQiwwREFBVztBQUN0QztBQUNnRCIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2F1dGgtaGVscGVycy01NTdiODNmYy5qcz8wNmY2Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHtcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG5pbXBvcnQgeyBMb2dnZXIsIGlzRW1wdHkgfSBmcm9tICdAYXdzLWFtcGxpZnkvY29yZSc7XG5pbXBvcnQgeyBBIGFzIEF1dGhTdGF0ZSwgQyBhcyBDaGFsbGVuZ2VOYW1lLCBVIGFzIFVzZXJuYW1lQWxpYXMgfSBmcm9tICcuL2F1dGgtdHlwZXMtNzhkZjMwNGUuanMnO1xuaW1wb3J0IHsgQXV0aCwgQ29nbml0b1VzZXIgfSBmcm9tICdAYXdzLWFtcGxpZnkvYXV0aCc7XG5pbXBvcnQgeyBUIGFzIFRyYW5zbGF0aW9ucyB9IGZyb20gJy4vVHJhbnNsYXRpb25zLTEwOGQ0NjlmLmpzJztcbmltcG9ydCB7IE4gYXMgTk9fQVVUSF9NT0RVTEVfRk9VTkQgfSBmcm9tICcuL2NvbnN0YW50cy1jOGVjYWEyNC5qcyc7XG5pbXBvcnQgeyBhIGFzIGRpc3BhdGNoVG9hc3RIdWJFdmVudCB9IGZyb20gJy4vaGVscGVycy0xNGZjYjUwYy5qcyc7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignYXV0aC1oZWxwZXJzJyk7XG5mdW5jdGlvbiBjaGVja0NvbnRhY3QodXNlciwgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGF0YSwgbmV3VXNlciwgZXJyb3JfMTtcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLnZlcmlmaWVkQ29udGFjdCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBgdXNlcmAgaXMgYSBmZWRlcmF0ZWQgdXNlciwgd2Ugc2hvdWxkbid0IGNhbGwgYHZlcmlmaWVkQ29udGFjdGBcbiAgICAgICAgICAgICAgICAgICAgLy8gc2luY2UgYHVzZXJgIGlzbid0IGBDb2duaXRvVXNlcmBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0NvZ25pdG9Vc2VyKHVzZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25lZEluLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLnZlcmlmaWVkQ29udGFjdCh1c2VyKV07XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHkoZGF0YS52ZXJpZmllZCkgfHwgaXNFbXB0eShkYXRhLnVudmVyaWZpZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25lZEluLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1VzZXIgPSBPYmplY3QuYXNzaWduKHVzZXIsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5WZXJpZnlDb250YWN0LCBuZXdVc2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl8xKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxudmFyIGhhbmRsZVNpZ25JbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZSwgdXNlcm5hbWVBbGlhcykgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdXNlciwgZXJyb3JfMjtcbiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGguc2lnbkluICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDksICwgMTBdKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLnNpZ25Jbih1c2VybmFtZSwgcGFzc3dvcmQpXTtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB1c2VyID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh1c2VyKTtcbiAgICAgICAgICAgICAgICBpZiAoISh1c2VyLmNoYWxsZW5nZU5hbWUgPT09IENoYWxsZW5nZU5hbWUuU01TTUZBIHx8XG4gICAgICAgICAgICAgICAgICAgIHVzZXIuY2hhbGxlbmdlTmFtZSA9PT0gQ2hhbGxlbmdlTmFtZS5Tb2Z0d2FyZVRva2VuTUZBKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdjb25maXJtIHVzZXIgd2l0aCAnICsgdXNlci5jaGFsbGVuZ2VOYW1lKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLkNvbmZpcm1TaWduSW4sIHVzZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIGlmICghKHVzZXIuY2hhbGxlbmdlTmFtZSA9PT0gQ2hhbGxlbmdlTmFtZS5OZXdQYXNzd29yZFJlcXVpcmVkKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdyZXF1aXJlIG5ldyBwYXNzd29yZCcsIHVzZXIuY2hhbGxlbmdlUGFyYW0pO1xuICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuUmVzZXRQYXNzd29yZCwgdXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgaWYgKCEodXNlci5jaGFsbGVuZ2VOYW1lID09PSBDaGFsbGVuZ2VOYW1lLk1GQVNldHVwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdUT1RQIHNldHVwJywgdXNlci5jaGFsbGVuZ2VQYXJhbSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5UT1RQU2V0dXAsIHVzZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGlmICghKHVzZXIuY2hhbGxlbmdlTmFtZSA9PT0gQ2hhbGxlbmdlTmFtZS5DdXN0b21DaGFsbGVuZ2UgJiZcbiAgICAgICAgICAgICAgICAgICAgdXNlci5jaGFsbGVuZ2VQYXJhbSAmJlxuICAgICAgICAgICAgICAgICAgICB1c2VyLmNoYWxsZW5nZVBhcmFtLnRyaWdnZXIgPT09ICd0cnVlJykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnY3VzdG9tIGNoYWxsZW5nZScsIHVzZXIuY2hhbGxlbmdlUGFyYW0pO1xuICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuQ3VzdG9tQ29uZmlybVNpZ25JbiwgdXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbNCAvKnlpZWxkKi8sIGNoZWNrQ29udGFjdCh1c2VyLCBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UpXTtcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xuICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgZXJyb3JfMiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3JfMi5jb2RlID09PSAnVXNlck5vdENvbmZpcm1lZEV4Y2VwdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCd0aGUgdXNlciBpcyBub3QgY29uZmlybWVkJyk7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuQ29uZmlybVNpZ25VcCwgeyB1c2VybmFtZTogdXNlcm5hbWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVycm9yXzIuY29kZSA9PT0gJ1Bhc3N3b3JkUmVzZXRSZXF1aXJlZEV4Y2VwdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCd0aGUgdXNlciByZXF1aXJlcyBhIG5ldyBwYXNzd29yZCcpO1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLkZvcmdvdFBhc3N3b3JkLCB7IHVzZXJuYW1lOiB1c2VybmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3JfMi5jb2RlID09PSAnSW52YWxpZFBhcmFtZXRlckV4Y2VwdGlvbicgJiYgcGFzc3dvcmQgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnUGFzc3dvcmQgY2Fubm90IGJlIGVtcHR5Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yXzIubWVzc2FnZSA9IFRyYW5zbGF0aW9ucy5FTVBUWV9QQVNTV09SRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3JfMi5tZXNzYWdlID09PSBUcmFuc2xhdGlvbnMuRU1QVFlfVVNFUk5BTUUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJuYW1lQWxpYXMgPT09IFVzZXJuYW1lQWxpYXMuZW1haWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzIubWVzc2FnZSA9IFRyYW5zbGF0aW9ucy5FTVBUWV9FTUFJTDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlcm5hbWVBbGlhcyA9PT0gVXNlcm5hbWVBbGlhcy5waG9uZV9udW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzIubWVzc2FnZSA9IFRyYW5zbGF0aW9ucy5FTVBUWV9QSE9ORTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfMik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICB9XG4gICAgfSk7XG59KTsgfTtcbnZhciBpc0NvZ25pdG9Vc2VyID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlciBpbnN0YW5jZW9mIENvZ25pdG9Vc2VyO1xufTtcbmV4cG9ydCB7IGNoZWNrQ29udGFjdCBhcyBjLCBoYW5kbGVTaWduSW4gYXMgaCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-557b83fc.js\n"));

/***/ })

}]);